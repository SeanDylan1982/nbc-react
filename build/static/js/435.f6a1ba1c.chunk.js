(self.webpackChunknbc_react=self.webpackChunknbc_react||[]).push([[435],{5790:function(e,t,n){"use strict";var r,i,s,o,a,u=n(1588).default,c=n(4968).default,f=n(3496).default,h=n(7061).default,l=n(7156).default,p=n(7424).default,d=n(861).default,y=n(6690).default,v=n(9728).default,g=n(6115).default,w=n(1655).default,m=n(6389).default,b=n(4704).default,x=Object.create,S=Object.defineProperty,E=Object.getOwnPropertyDescriptor,A=Object.getOwnPropertyNames,_=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty,U=function(e,t){return function(){return e&&(t=e(e=0)),t}},C=function(e,t){return function(){return t||e((t={exports:{}}).exports,t),t.exports}},L=function(e,t){for(var n in t)S(e,n,{get:t[n],enumerable:!0})},I=function(e,t,n,r){if(t&&"object"==typeof t||"function"==typeof t){var i,s=b(A(t));try{var o=function(){var s=i.value;!k.call(e,s)&&s!==n&&S(e,s,{get:function(){return t[s]},enumerable:!(r=E(t,s))||r.enumerable})};for(s.s();!(i=s.n()).done;)o()}catch(a){s.e(a)}finally{s.f()}}return e},M=function(e,t,n){return n=null!=e?x(_(e)):{},I(!t&&e&&e.__esModule?n:S(n,"default",{value:e,enumerable:!0}),e)},T=function(e){return I(S({},"__esModule",{value:!0}),e)},R=function(e,t,n){return function(e,t,n){t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=typeof t?t+"":t,n),n},P=C((function(e){N(),e.byteLength=function(e){var t=o(e),n=t[0],r=t[1];return 3*(n+r)/4-r},e.toByteArray=function(e){var t,n,s=o(e),a=s[0],u=s[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,u)),f=0,h=u>0?a-4:a;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[f++]=t>>16&255,c[f++]=t>>8&255,c[f++]=255&t;return 2===u&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[f++]=255&t),1===u&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[f++]=t>>8&255,c[f++]=255&t),c},e.fromByteArray=function(e){for(var t,r=e.length,i=r%3,s=[],o=16383,a=0,c=r-i;a<c;a+=o)s.push(u(e,a,a+o>c?c:a+o));return 1===i?(t=e[r-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),s.join("")};var t,n=[],r=[],i=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0,64;t<64;++t)n[t]=s[t],r[s.charCodeAt(t)]=t;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function a(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function u(e,t,n){for(var r,i=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(a(r));return i.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63})),O=C((function(e){N(),e.read=function(e,t,n,r,i){var s,o,a=8*i-r-1,u=(1<<a)-1,c=u>>1,f=-7,h=n?i-1:0,l=n?-1:1,p=e[t+h];for(h+=l,s=p&(1<<-f)-1,p>>=-f,f+=a;f>0;s=256*s+e[t+h],h+=l,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=r;f>0;o=256*o+e[t+h],h+=l,f-=8);if(0===s)s=1-c;else{if(s===u)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),s-=c}return(p?-1:1)*o*Math.pow(2,s-r)},e.write=function(e,t,n,r,i,s){var o,a,u,c=8*s-i-1,f=(1<<c)-1,h=f>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,d=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=f):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+h>=1?l/u:l*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=f?(a=0,o=f):o+h>=1?(a=(t*u-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+p]=255&a,p+=d,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;e[n+p]=255&o,p+=d,o/=256,c-=8);e[n+p-d]|=128*y}})),B=C((function(e){N();var t=P(),n=O(),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},e.INSPECT_MAX_BYTES=50;var i=2147483647;function s(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return a(e,t,n)}function a(e,t,n){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|p(e,t),r=s(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(te(e,Uint8Array)){var t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(te(e,ArrayBuffer)||e&&te(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(te(e,SharedArrayBuffer)||e&&te(e.buffer,SharedArrayBuffer)))return h(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return o.from(r,t,n);var i=function(e){if(o.isBuffer(e)){var t=0|l(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||ne(e.length)?s(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return u(e),s(e<0?0:0|l(e))}function f(e){for(var t=e.length<0?0:0|l(e.length),n=s(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,o.prototype),r}function l(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function p(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||te(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(e).length;default:if(i)return r?-1:X(e).length;t=(""+t).toLowerCase(),i=!0}}function d(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0)||(n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return L(this,t,n);case"ascii":return M(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function b(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function x(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),ne(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:S(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):S(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function S(e,t,n,r,i){var s,o=1,a=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,u/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var f=-1;for(s=n;s<a;s++)if(c(e,s)===c(t,-1===f?0:s-f)){if(-1===f&&(f=s),s-f+1===u)return f*o}else-1!==f&&(s-=s-f),f=-1}else for(n+u>a&&(n=a-u),s=n;s>=0;s--){for(var h=!0,l=0;l<u;l++)if(c(e,s+l)!==c(t,l)){h=!1;break}if(h)return s}return-1}function E(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s,o=t.length;for(r>o/2&&(r=o/2),s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(ne(a))return s;e[n+s]=a}return s}function A(e,t,n,r){return ee(X(t,e.length-n),e,n,r)}function _(e,t,n,r){return ee(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return ee($(t),e,n,r)}function U(e,t,n,r){return ee(function(e,t){for(var n,r,i,s=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(t,e.length-n),e,n,r)}function C(e,n,r){return 0===n&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(n,r))}function L(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var s=e[i],o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a<=n){var u=void 0,c=void 0,f=void 0,h=void 0;switch(a){case 1:s<128&&(o=s);break;case 2:128===(192&(u=e[i+1]))&&((h=(31&s)<<6|63&u)>127&&(o=h));break;case 3:u=e[i+1],c=e[i+2],128===(192&u)&&128===(192&c)&&((h=(15&s)<<12|(63&u)<<6|63&c)>2047&&(h<55296||h>57343)&&(o=h));break;case 4:u=e[i+1],c=e[i+2],f=e[i+3],128===(192&u)&&128===(192&c)&&128===(192&f)&&((h=(15&s)<<18|(63&u)<<12|(63&c)<<6|63&f)>65535&&h<1114112&&(o=h))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=a}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=I));return n}(r)}e.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(n){return!1}}(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,n){return a(e,t,n)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},o.allocUnsafe=function(e){return c(e)},o.allocUnsafeSlow=function(e){return c(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(te(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),te(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=o.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(te(s,Uint8Array))i+s.length>r.length?(o.isBuffer(s)||(s=o.from(s)),s.copy(r,i)):Uint8Array.prototype.set.call(r,s,i);else{if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i)}i+=s.length}return r},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?L(this,0,e):d.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(e,t,n,r,i){if(te(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),u=Math.min(s,a),c=this.slice(r,i),f=e.slice(t,n),h=0;h<u;++h)if(c[h]!==f[h]){s=c[h],a=f[h];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return x(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return x(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return A(this,e,t,n);case"ascii":case"latin1":case"binary":return _(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function M(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function R(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",s=t;s<n;++s)i+=re[e[s]];return i}function B(e,t,n){for(var r=e.slice(t,n),i="",s=0;s<r.length-1;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function D(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,n,r,i,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function Q(e,t,n,r,i){Z(t,r,i,e,n,7);var s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function F(e,t,n,r,i){Z(t,r,i,e,n,7);var s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function H(e,t,n,r,i,s){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function q(e,t,r,i,s){return t=+t,r>>>=0,s||H(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function K(e,t,r,i,s){return t=+t,r>>>=0,s||H(e,0,r,8),n.write(e,t,r,i,52,8),r+8}o.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,o.prototype),r},o.prototype.readUintLE=o.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);for(var r=this[e],i=1,s=0;++s<t&&(i*=256);)r+=this[e+s]*i;return r},o.prototype.readUintBE=o.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},o.prototype.readUint8=o.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readBigUInt64LE=ie((function(e){z(e>>>=0,"offset");var t=this[e],n=this[e+7];(void 0===t||void 0===n)&&Y(e,this.length-8);var r=t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24),i=this[++e]+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+n*Math.pow(2,24);return BigInt(r)+(BigInt(i)<<BigInt(32))})),o.prototype.readBigUInt64BE=ie((function(e){z(e>>>=0,"offset");var t=this[e],n=this[e+7];(void 0===t||void 0===n)&&Y(e,this.length-8);var r=t*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e],i=this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),o.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);for(var r=this[e],i=1,s=0;++s<t&&(i*=256);)r+=this[e+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);for(var r=t,i=1,s=this[e+--r];r>0&&(i*=256);)s+=this[e+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},o.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readBigInt64LE=ie((function(e){z(e>>>=0,"offset");var t=this[e],n=this[e+7];(void 0===t||void 0===n)&&Y(e,this.length-8);var r=this[e+4]+this[e+5]*Math.pow(2,8)+this[e+6]*Math.pow(2,16)+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24))})),o.prototype.readBigInt64BE=ie((function(e){z(e>>>=0,"offset");var t=this[e],n=this[e+7];(void 0===t||void 0===n)&&Y(e,this.length-8);var r=(t<<24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+n)})),o.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),n.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),n.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),n.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),n.read(this,e,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||j(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||j(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},o.prototype.writeUint8=o.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigUInt64LE=ie((function(e){return Q(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),o.prototype.writeBigUInt64BE=ie((function(e){return F(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);j(this,e,t,n,i-1,-i)}var s=0,o=1,a=0;for(this[t]=255&e;++s<n&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);j(this,e,t,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigInt64LE=ie((function(e){return Q(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),o.prototype.writeBigInt64BE=ie((function(e){return F(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),o.prototype.writeFloatLE=function(e,t,n){return q(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return q(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return K(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return K(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!r&&0!==r&&(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n||0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},o.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var a=o.isBuffer(e)?e:o.from(e,r),u=a.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=a[s%u]}return this};var V={};function G(e,t,n){V[e]=function(n){w(i,n);var r=m(i);function i(){var n;return y(this,i),n=r.call(this),Object.defineProperty(g(n),"message",{value:t.apply(g(n),arguments),writable:!0,configurable:!0}),n.name="".concat(n.name," [").concat(e,"]"),n.stack,delete n.name,n}return v(i,[{key:"code",get:function(){return e},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),i}(n)}function W(e){for(var t="",n=e.length,r="-"===e[0]?1:0;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function Z(e,t,n,r,i,s){if(e>n||e<t){var o,a="bigint"==typeof t?"n":"";throw o=s>3?0===t||t===BigInt(0)?">= 0".concat(a," and < 2").concat(a," ** ").concat(8*(s+1)).concat(a):">= -(2".concat(a," ** ").concat(8*(s+1)-1).concat(a,") and < 2 ** ").concat(8*(s+1)-1).concat(a):">= ".concat(t).concat(a," and <= ").concat(n).concat(a),new V.ERR_OUT_OF_RANGE("value",o,e)}!function(e,t,n){z(t,"offset"),(void 0===e[t]||void 0===e[t+n])&&Y(t,e.length-(n+1))}(r,i,s)}function z(e,t){if("number"!=typeof e)throw new V.ERR_INVALID_ARG_TYPE(t,"number",e)}function Y(e,t,n){throw Math.floor(e)!==e?(z(e,n),new V.ERR_OUT_OF_RANGE(n||"offset","an integer",e)):t<0?new V.ERR_BUFFER_OUT_OF_BOUNDS:new V.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}G("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),G("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),G("ERR_OUT_OF_RANGE",(function(e,t,n){var r='The value of "'.concat(e,'" is out of range.'),i=n;return Number.isInteger(n)&&Math.abs(n)>Math.pow(2,32)?i=W(String(n)):"bigint"==typeof n&&(i=String(n),(n>Math.pow(BigInt(2),BigInt(32))||n<-Math.pow(BigInt(2),BigInt(32)))&&(i=W(i)),i+="n"),r+=" It must be ".concat(t,". Received ").concat(i)}),RangeError);var J=/[^+/0-9A-Za-z-_]/g;function X(e,t){t=t||1/0;for(var n,r=e.length,i=null,s=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function $(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(J,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function ee(e,t,n,r){var i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function te(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ne(e){return e!==e}var re=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}();function ie(e){return typeof BigInt>"u"?se:e}function se(){throw new Error("BigInt not supported")}})),N=U((function(){var e,t,n,u,c,f;r=globalThis,i=null!==(e=globalThis.setImmediate)&&void 0!==e?e:function(e){return setTimeout(e,0)},null!==(t=globalThis.clearImmediate)&&void 0!==t?t:function(e){return clearTimeout(e)},null!==(u=(s=null!==(n=globalThis.crypto)&&void 0!==n?n:{}).subtle)&&void 0!==u||(s.subtle={}),o="function"==typeof globalThis.Buffer&&"function"==typeof globalThis.Buffer.allocUnsafe?globalThis.Buffer:B().Buffer,null!==(f=(a=null!==(c=globalThis.process)&&void 0!==c?c:{}).env)&&void 0!==f||(a.env={});try{a.nextTick((function(){}))}catch(l){var h=Promise.resolve();a.nextTick=h.then.bind(h)}})),D=C((function(e,t){N();var n,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!==e};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,s),r(n)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}v(e,t,s,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&v(e,"error",t,n)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function f(e,t,n,r){var i,s,o;if(u(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=c(e))>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,function(e){console&&console.warn&&console.warn(e)}(a)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=h.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(s){r.once&&e.removeEventListener(t,i),n(s)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=s[e];if(void 0===u)return!1;if("function"==typeof u)i(u,this,t);else{var c=u.length,f=y(u,c);for(n=0;n<c;++n)i(f[n],this,t)}return!0},o.prototype.addListener=function(e,t){return f(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return f(this,e,t,!0)},o.prototype.once=function(e,t){return u(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,s,o;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},o.prototype.listenerCount=d,o.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}}));function j(e){var t=1779033703,n=3144134277,r=1013904242,i=2773480762,s=1359893119,o=2600822924,a=528734635,u=1541459225,c=0,f=0,h=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=function(e,t){return e>>>t|e<<32-t},p=new Uint32Array(64),d=new Uint8Array(64),y=function(){for(var e=0,c=0;e<16;e++,c+=4)p[e]=d[c]<<24|d[c+1]<<16|d[c+2]<<8|d[c+3];for(var y=16;y<64;y++){var v=l(p[y-15],7)^l(p[y-15],18)^p[y-15]>>>3,g=l(p[y-2],17)^l(p[y-2],19)^p[y-2]>>>10;p[y]=p[y-16]+v+p[y-7]+g|0}for(var w=t,m=n,b=r,x=i,S=s,E=o,A=a,_=u,k=0;k<64;k++){var U=_+(l(S,6)^l(S,11)^l(S,25))+(S&E^~S&A)+h[k]+p[k]|0,C=w&m^w&b^m&b;_=A,A=E,E=S,S=x+U|0,x=b,b=m,m=w,w=U+((l(w,2)^l(w,13)^l(w,22))+C|0)|0}t=t+w|0,n=n+m|0,r=r+b|0,i=i+x|0,s=s+S|0,o=o+E|0,a=a+A|0,u=u+_|0,f=0},v=function(e){"string"==typeof e&&(e=(new TextEncoder).encode(e));for(var t=0;t<e.length;t++)d[f++]=e[t],64===f&&y();c+=e.length},g=function(){if(d[f++]=128,64==f&&y(),f+8>64){for(;f<64;)d[f++]=0;y()}for(;f<58;)d[f++]=0;var e=8*c;d[f++]=e/1099511627776&255,d[f++]=e/4294967296&255,d[f++]=e>>>24,d[f++]=e>>>16&255,d[f++]=e>>>8&255,d[f++]=255&e,y();var h=new Uint8Array(32);return h[0]=t>>>24,h[1]=t>>>16&255,h[2]=t>>>8&255,h[3]=255&t,h[4]=n>>>24,h[5]=n>>>16&255,h[6]=n>>>8&255,h[7]=255&n,h[8]=r>>>24,h[9]=r>>>16&255,h[10]=r>>>8&255,h[11]=255&r,h[12]=i>>>24,h[13]=i>>>16&255,h[14]=i>>>8&255,h[15]=255&i,h[16]=s>>>24,h[17]=s>>>16&255,h[18]=s>>>8&255,h[19]=255&s,h[20]=o>>>24,h[21]=o>>>16&255,h[22]=o>>>8&255,h[23]=255&o,h[24]=a>>>24,h[25]=a>>>16&255,h[26]=a>>>8&255,h[27]=255&a,h[28]=u>>>24,h[29]=u>>>16&255,h[30]=u>>>8&255,h[31]=255&u,h};return void 0===e?{add:v,digest:g}:(v(e),g())}var Q=U((function(){N()})),F={};function H(e){return s.getRandomValues(o.alloc(e))}function q(e){if("sha256"!==e)throw new Error("Only sha256 is supported");return{update:function(e){return{digest:function(){return o.from(j(e))}}}}}function K(e,t){if("sha256"!==e)throw new Error("Only sha256 is supported");return{update:function(e){return{digest:function(){"string"==typeof t&&(t=(new TextEncoder).encode(t)),"string"==typeof e&&(e=(new TextEncoder).encode(e));var n=t.length;if(n>64)t=j(t);else if(n<64){var r=new Uint8Array(64);r.set(t),t=r}for(var i=new Uint8Array(64),s=new Uint8Array(64),a=0;a<64;a++)i[a]=54^t[a],s[a]=92^t[a];var u=new Uint8Array(e.length+64);u.set(i,0),u.set(e,64);var c=new Uint8Array(96);return c.set(s,0),c.set(j(u),64),o.from(j(c))}}}}}L(F,{createHash:function(){return q},createHmac:function(){return K},randomBytes:function(){return H}});var V=U((function(){N(),Q()})),G=C((function(e){N(),e.parse=function(e,n){return new t(e,n).parse()};var t=function(){function e(t,r){y(this,e),this.source=t,this.transform=r||n,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}return v(e,[{key:"isEof",value:function(){return this.position>=this.source.length}},{key:"nextCharacter",value:function(){var e=this.source[this.position++];return"\\"===e?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}},{key:"record",value:function(e){this.recorded.push(e)}},{key:"newEntry",value:function(e){var t;(this.recorded.length>0||e)&&("NULL"===(t=this.recorded.join(""))&&!e&&(t=null),null!==t&&(t=this.transform(t)),this.entries.push(t),this.recorded=[])}},{key:"consumeDimensions",value:function(){if("["===this.source[0])for(;!this.isEof();){if("="===this.nextCharacter().value)break}}},{key:"parse",value:function(t){var n,r,i;for(this.consumeDimensions();!this.isEof();)if("{"!==(n=this.nextCharacter()).value||i){if("}"!==n.value||i)'"'!==n.value||n.escaped?","!==n.value||i?this.record(n.value):this.newEntry():(i&&this.newEntry(!0),i=!i);else if(this.dimension--,!this.dimension&&(this.newEntry(),t))return this.entries}else this.dimension++,this.dimension>1&&(r=new e(this.source.substr(this.position-1),this.transform),this.entries.push(r.parse(!0)),this.position+=r.position-2);if(0!==this.dimension)throw new Error("array dimension not balanced");return this.entries}}]),e}();function n(e){return e}})),W=C((function(e,t){N();var n=G();t.exports={create:function(e,t){return{parse:function(){return n.parse(e,t)}}}}})),Z=C((function(e,t){N();var n=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,r=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,i=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,s=/^-?infinity$/;function o(e){return-(e-1)}function a(e){return e>=0&&e<100}t.exports=function(e){if(s.test(e))return Number(e.replace("i","I"));var t=n.exec(e);if(!t)return function(e){var t=r.exec(e);if(t){var n=parseInt(t[1],10);!!t[4]&&(n=o(n));var i=parseInt(t[2],10)-1,s=t[3],u=new Date(n,i,s);return a(n)&&u.setFullYear(n),u}}(e)||null;var u=!!t[8],c=parseInt(t[1],10);u&&(c=o(c));var f=parseInt(t[2],10)-1,h=t[3],l=parseInt(t[4],10),p=parseInt(t[5],10),d=parseInt(t[6],10),y=t[7];y=y?1e3*parseFloat(y):0;var v,g=function(e){if(e.endsWith("+00"))return 0;var t=i.exec(e.split(" ")[1]);if(t){var n=t[1];if("Z"===n)return 0;var r="-"===n?-1:1;return(3600*parseInt(t[2],10)+60*parseInt(t[3]||0,10)+parseInt(t[4]||0,10))*r*1e3}}(e);return null!=g?(v=new Date(Date.UTC(c,f,h,l,p,d,y)),a(c)&&v.setUTCFullYear(c),0!==g&&v.setTime(v.getTime()-g)):(v=new Date(c,f,h,l,p,d,y),a(c)&&v.setFullYear(c)),v}})),z=C((function(e,t){N(),t.exports=function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty})),Y=C((function(e,t){N();var n=z();function r(e){if(!(this instanceof r))return new r(e);n(this,function(e){if(!e)return{};var t=c.exec(e),n="-"===t[8];return Object.keys(f).reduce((function(e,r){var i=f[r],s=t[i];return!s||(s="milliseconds"===r?function(e){var t=e+"000000".slice(e.length);return parseInt(t,10)/1e3}(s):parseInt(s,10),!s)||(n&&~h.indexOf(r)&&(s*=-1),e[r]=s),e}),{})}(e))}t.exports=r;var i=["seconds","minutes","hours","days","months","years"];r.prototype.toPostgres=function(){var e=i.filter(this.hasOwnProperty,this);return this.milliseconds&&e.indexOf("seconds")<0&&e.push("seconds"),0===e.length?"0":e.map((function(e){var t=this[e]||0;return"seconds"===e&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),t+" "+e}),this).join(" ")};var s={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},o=["years","months","days"],a=["hours","minutes","seconds"];r.prototype.toISOString=r.prototype.toISO=function(){return"P"+o.map(e,this).join("")+"T"+a.map(e,this).join("");function e(e){var t=this[e]||0;return"seconds"===e&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),t+s[e]}};var u="([+-]?\\d+)",c=new RegExp([u+"\\s+years?",u+"\\s+mons?",u+"\\s+days?","([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?"].map((function(e){return"("+e+")?"})).join("\\s*")),f={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},h=["hours","minutes","seconds","milliseconds"]})),J=C((function(e,t){N(),t.exports=function(e){if(/^\\x/.test(e))return new o(e.substr(2),"hex");for(var t="",n=0;n<e.length;)if("\\"!==e[n])t+=e[n],++n;else if(/[0-7]{3}/.test(e.substr(n+1,3)))t+=String.fromCharCode(parseInt(e.substr(n+1,3),8)),n+=4;else{for(var r=1;n+r<e.length&&"\\"===e[n+r];)r++;for(var i=0;i<Math.floor(r/2);++i)t+="\\";n+=2*Math.floor(r/2)}return new o(t,"binary")}})),X=C((function(e,t){N();var n=G(),r=W(),i=Z(),s=Y(),o=J();function a(e){return function(t){return null===t?t:e(t)}}function u(e){return null===e?e:"TRUE"===e||"t"===e||"true"===e||"y"===e||"yes"===e||"on"===e||"1"===e}function c(e){return e?n.parse(e,u):null}function f(e){return parseInt(e,10)}function h(e){return e?n.parse(e,a(f)):null}function l(e){return e?n.parse(e,a((function(e){return b(e).trim()}))):null}var p=function(e){return e?r.create(e,(function(e){return null!==e&&(e=S(e)),e})).parse():null},d=function(e){return e?r.create(e,(function(e){return null!==e&&(e=parseFloat(e)),e})).parse():null},y=function(e){return e?r.create(e).parse():null},v=function(e){return e?r.create(e,(function(e){return null!==e&&(e=i(e)),e})).parse():null},g=function(e){return e?r.create(e,(function(e){return null!==e&&(e=s(e)),e})).parse():null},w=function(e){return e?n.parse(e,a(o)):null},m=function(e){return parseInt(e,10)},b=function(e){var t=String(e);return/^\d+$/.test(t)?t:e},x=function(e){return e?n.parse(e,a(JSON.parse)):null},S=function(e){return"("!==e[0]?null:(e=e.substring(1,e.length-1).split(","),{x:parseFloat(e[0]),y:parseFloat(e[1])})},E=function(e){if("<"!==e[0]&&"("!==e[1])return null;for(var t="(",n="",r=!1,i=2;i<e.length-1;i++)r||(t+=e[i]),")"!==e[i]?r&&","!==e[i]&&(n+=e[i]):r=!0;var s=S(t);return s.radius=parseFloat(n),s};t.exports={init:function(e){e(20,b),e(21,m),e(23,m),e(26,m),e(700,parseFloat),e(701,parseFloat),e(16,u),e(1082,i),e(1114,i),e(1184,i),e(600,S),e(651,y),e(718,E),e(1e3,c),e(1001,w),e(1005,h),e(1007,h),e(1028,h),e(1016,l),e(1017,p),e(1021,d),e(1022,d),e(1231,d),e(1014,y),e(1015,y),e(1008,y),e(1009,y),e(1040,y),e(1041,y),e(1115,v),e(1182,v),e(1185,v),e(1186,s),e(1187,g),e(17,o),e(114,JSON.parse.bind(JSON)),e(3802,JSON.parse.bind(JSON)),e(199,x),e(3807,x),e(3907,y),e(2951,y),e(791,y),e(1183,y),e(1270,y)}}})),$=C((function(e,t){N();var n=1e6;t.exports=function(e){var t=e.readInt32BE(0),r=e.readUInt32BE(4),i="";t<0&&(t=~t+(0===r),r=1+~r>>>0,i="-");var s,o,a,u,c,f,h="";if(s=t%n,t=t/n>>>0,a=""+((o=4294967296*s+r)-n*(r=o/n>>>0)),0===r&&0===t)return i+a+h;for(u="",c=6-a.length,f=0;f<c;f++)u+="0";if(h=u+a+h,s=t%n,t=t/n>>>0,a=""+((o=4294967296*s+r)-n*(r=o/n>>>0)),0===r&&0===t)return i+a+h;for(u="",c=6-a.length,f=0;f<c;f++)u+="0";if(h=u+a+h,s=t%n,t=t/n>>>0,a=""+((o=4294967296*s+r)-n*(r=o/n>>>0)),0===r&&0===t)return i+a+h;for(u="",c=6-a.length,f=0;f<c;f++)u+="0";return h=u+a+h,i+(a=""+(o=4294967296*(s=t%n)+r)%n)+h}})),ee=C((function(e,t){N();var n=$(),r=function(e,t,n,r,i){r=r||!1,i=i||function(e,t,n){return e*Math.pow(2,n)+t};var s=(n=n||0)>>3,o=function(e){return r?255&~e:e},a=255,u=8-n%8;t<u&&(a=255<<8-t&255,u=t),n&&(a>>=n%8);var c=0;n%8+t>=8&&(c=i(0,o(e[s])&a,u));for(var f=t+n>>3,h=s+1;h<f;h++)c=i(c,o(e[h]),8);var l=(t+n)%8;return l>0&&(c=i(c,o(e[f])>>8-l,l)),c},i=function(e,t,n){var i=Math.pow(2,n-1)-1,s=r(e,1),o=r(e,n,1);if(0===o)return 0;var a=1,u=r(e,t,n+1,!1,(function(e,t,n){0===e&&(e=1);for(var r=1;r<=n;r++)a/=2,(t&1<<n-r)>0&&(e+=a);return e}));return o==Math.pow(2,n+1)-1?0===u?0===s?1/0:-1/0:NaN:(0===s?1:-1)*Math.pow(2,o-i)*u},s=function(e){return 1==r(e,1)?-1*(r(e,15,1,!0)+1):r(e,15,1)},o=function(e){return 1==r(e,1)?-1*(r(e,31,1,!0)+1):r(e,31,1)},a=function(e){return i(e,23,8)},u=function(e){return i(e,52,11)},c=function(e){var t=r(e,16,32);if(49152==t)return NaN;for(var n=Math.pow(1e4,r(e,16,16)),i=0,s=r(e,16),o=0;o<s;o++)i+=r(e,16,64+16*o)*n,n/=1e4;var a=Math.pow(10,r(e,16,48));return(0===t?1:-1)*Math.round(i*a)/a},f=function(e,t){var n=r(t,1),i=r(t,63,1),s=new Date((0===n?1:-1)*i/1e3+9466848e5);return e||s.setTime(s.getTime()+6e4*s.getTimezoneOffset()),s.usec=i%1e3,s.getMicroSeconds=function(){return this.usec},s.setMicroSeconds=function(e){this.usec=e},s.getUTCMicroSeconds=function(){return this.usec},s},h=function(e){for(var t=r(e,32),n=(r(e,32,32),r(e,32,64)),i=96,s=[],o=0;o<t;o++)s[o]=r(e,32,i),i+=32,i+=32;var a=function(t){var n,s=r(e,32,i);return i+=32,4294967295==s?null:23==t||20==t?(n=r(e,8*s,i),i+=8*s,n):25==t?n=e.toString(this.encoding,i>>3,(i+=s<<3)>>3):void console.log("ERROR: ElementType not implemented: "+t)};return function e(t,n){var r,i=[];if(t.length>1){var s=t.shift();for(r=0;r<s;r++)i[r]=e(t,n);t.unshift(s)}else for(r=0;r<t[0];r++)i[r]=a(n);return i}(s,n)},l=function(e){return e.toString("utf8")},p=function(e){return null===e?null:r(e,8)>0};t.exports={init:function(e){e(20,n),e(21,s),e(23,o),e(26,o),e(1700,c),e(700,a),e(701,u),e(16,p),e(1114,f.bind(null,!1)),e(1184,f.bind(null,!0)),e(1e3,h),e(1007,h),e(1016,h),e(1008,h),e(1009,h),e(25,l)}}})),te=C((function(e,t){N(),t.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}})),ne=C((function(e){N();var t=X(),n=ee(),r=W(),i=te();e.getTypeParser=function(e,t){return s[t=t||"text"]&&s[t][e]||o},e.setTypeParser=function(e,t,n){"function"==typeof t&&(n=t,t="text"),s[t][e]=n},e.arrayParser=r,e.builtins=i;var s={text:{},binary:{}};function o(e){return String(e)}t.init((function(e,t){s.text[e]=t})),n.init((function(e,t){s.binary[e]=t}))})),re=C((function(e,t){N(),t.exports={host:"localhost",user:"win32"===a.platform?a.env.USERNAME:a.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var n=ne(),r=n.getTypeParser(20,"text"),i=n.getTypeParser(1016,"text");t.exports.__defineSetter__("parseInt8",(function(e){n.setTypeParser(20,"text",e?n.getTypeParser(23,"text"):r),n.setTypeParser(1016,"text",e?n.getTypeParser(1007,"text"):i)}))})),ie=C((function(e,t){N();var n=(V(),T(F)),r=re();function i(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function s(e){for(var t="{",n=0;n<e.length;n++)n>0&&(t+=","),null===e[n]||typeof e[n]>"u"?t+="NULL":Array.isArray(e[n])?t+=s(e[n]):e[n]instanceof o?t+="\\\\x"+e[n].toString("hex"):t+=i(a(e[n]));return t+="}"}var a=function(e,t){if(null==e)return null;if(e instanceof o)return e;if(ArrayBuffer.isView(e)){var n=o.from(e.buffer,e.byteOffset,e.byteLength);return n.length===e.byteLength?n:n.slice(e.byteOffset,e.byteOffset+e.byteLength)}return e instanceof Date?r.parseInputDatesAsUTC?function(e){var t=e.getUTCFullYear(),n=t<1;n&&(t=Math.abs(t)+1);var r=c(t,4)+"-"+c(e.getUTCMonth()+1,2)+"-"+c(e.getUTCDate(),2)+"T"+c(e.getUTCHours(),2)+":"+c(e.getUTCMinutes(),2)+":"+c(e.getUTCSeconds(),2)+"."+c(e.getUTCMilliseconds(),3);return r+="+00:00",n&&(r+=" BC"),r}(e):function(e){var t=-e.getTimezoneOffset(),n=e.getFullYear(),r=n<1;r&&(n=Math.abs(n)+1);var i=c(n,4)+"-"+c(e.getMonth()+1,2)+"-"+c(e.getDate(),2)+"T"+c(e.getHours(),2)+":"+c(e.getMinutes(),2)+":"+c(e.getSeconds(),2)+"."+c(e.getMilliseconds(),3);return t<0?(i+="-",t*=-1):i+="+",i+=c(Math.floor(t/60),2)+":"+c(t%60,2),r&&(i+=" BC"),i}(e):Array.isArray(e)?s(e):"object"==typeof e?u(e,t):e.toString()};function u(e,t){if(e&&"function"==typeof e.toPostgres){if(-1!==(t=t||[]).indexOf(e))throw new Error('circular reference detected while preparing "'+e+'" for query');return t.push(e),a(e.toPostgres(a),t)}return JSON.stringify(e)}function c(e,t){for(e=""+e;e.length<t;)e="0"+e;return e}var f=function(e){return n.createHash("md5").update(e,"utf-8").digest("hex")};t.exports={prepareValue:function(e){return a(e)},normalizeQueryConfig:function(e,t,n){return e="string"==typeof e?{text:e}:e,t&&("function"==typeof t?e.callback=t:e.values=t),n&&(e.callback=n),e},postgresMd5PasswordHash:function(e,t,n){var r=f(t+e);return"md5"+f(o.concat([o.from(r),n]))},md5:f}})),se=C((function(e,t){N();var n=(V(),T(F));function r(e){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(e)}function i(e){if("string"!=typeof e)throw new TypeError("SASL: attribute pairs text must be a string");return new Map(e.split(",").map((function(e){if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");return[e[0],e.substring(2)]})))}function s(e,t){return n.createHmac("sha256",e).update(t).digest()}t.exports={startSession:function(e){if(-1===e.indexOf("SCRAM-SHA-256"))throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");var t=n.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:t,response:"n,,n=*,r="+t,message:"SASLInitialResponse"}},continueSession:function(e,t,a){if("SASLInitialResponse"!==e.message)throw new Error("SASL: Last message was not SASLInitialResponse");if("string"!=typeof t)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(""===t)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if("string"!=typeof a)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");var u=function(e){var t=i(e),n=t.get("r");if(!n)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");if(!function(e){if("string"!=typeof e)throw new TypeError("SASL: text must be a string");return e.split("").map((function(t,n){return e.charCodeAt(n)})).every((function(e){return e>=33&&e<=43||e>=45&&e<=126}))}(n))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters");var s=t.get("s");if(!s)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");if(!r(s))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64");var o=t.get("i");if(!o)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");if(!/^[1-9][0-9]*$/.test(o))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count");var a=parseInt(o,10);return{nonce:n,salt:s,iteration:a}}(a);if(!u.nonce.startsWith(e.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(u.nonce.length===e.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");var c=o.from(u.salt,"base64"),f=n.pbkdf2Sync(t,c,u.iteration,32,"sha256"),h=s(f,"Client Key"),l=function(e){return n.createHash("sha256").update(e).digest()}(h),p="n=*,r="+e.clientNonce,d="r="+u.nonce+",s="+u.salt+",i="+u.iteration,y="c=biws,r="+u.nonce,v=p+","+d+","+y,g=function(e,t){if(!o.isBuffer(e))throw new TypeError("first argument must be a Buffer");if(!o.isBuffer(t))throw new TypeError("second argument must be a Buffer");if(e.length!==t.length)throw new Error("Buffer lengths must match");if(0===e.length)throw new Error("Buffers cannot be empty");return o.from(e.map((function(n,r){return e[r]^t[r]})))}(h,s(l,v)).toString("base64"),w=s(f,"Server Key"),m=s(w,v);e.message="SASLResponse",e.serverSignature=m.toString("base64"),e.response=y+",p="+g},finalizeSession:function(e,t){if("SASLResponse"!==e.message)throw new Error("SASL: Last message was not SASLResponse");if("string"!=typeof t)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");if(function(e){var t=i(e).get("v");if(!t)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");if(!r(t))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64");return{serverSignature:t}}(t).serverSignature!==e.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}}})),oe={};function ae(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("/")}L(oe,{join:function(){return ae}});var ue=U((function(){N()})),ce={};function fe(e,t){t(new Error("No filesystem"))}L(ce,{stat:function(){return fe}});var he=U((function(){N()})),le={};L(le,{default:function(){return pe}});var pe,de=U((function(){N(),pe={}})),ye={};L(ye,{StringDecoder:function(){return ve}});var ve,ge=U((function(){N(),ve=function(){function e(t){y(this,e),this.td=new TextDecoder(t)}return v(e,[{key:"write",value:function(e){return this.td.decode(e,{stream:!0})}},{key:"end",value:function(e){return this.td.decode(e)}}]),e}()})),we=C((function(e,t){N();var n=(de(),T(le)).Transform,r=(ge(),T(ye)).StringDecoder,i=Symbol("last"),s=Symbol("decoder");function o(e,t,n){var r;if(this.overflow){if(1===(r=this[s].write(e).split(this.matcher)).length)return n();r.shift(),this.overflow=!1}else this[i]+=this[s].write(e),r=this[i].split(this.matcher);this[i]=r.pop();for(var o=0;o<r.length;o++)try{u(this,this.mapper(r[o]))}catch(a){return n(a)}this.overflow=this[i].length>this.maxLength,!this.overflow||this.skipOverflow?n():n(new Error("maximum buffer reached"))}function a(e){if(this[i]+=this[s].end(),this[i])try{u(this,this.mapper(this[i]))}catch(t){return e(t)}e()}function u(e,t){void 0!==t&&e.push(t)}function c(e){return e}t.exports=function(e,t,u){switch(e=e||/\r?\n/,t=t||c,u=u||{},arguments.length){case 1:"function"==typeof e?(t=e,e=/\r?\n/):"object"==typeof e&&!(e instanceof RegExp)&&(u=e,e=/\r?\n/);break;case 2:"function"==typeof e?(u=t,t=e,e=/\r?\n/):"object"==typeof t&&(u=t,t=c)}(u=Object.assign({},u)).autoDestroy=!0,u.transform=o,u.flush=a,u.readableObjectMode=!0;var f=new n(u);return f[i]="",f[s]=new r("utf8"),f.matcher=e,f.mapper=t,f.maxLength=u.maxLength,f.skipOverflow=u.skipOverflow||!1,f.overflow=!1,f._destroy=function(e,t){this._writableState.errorEmitted=!1,t(e)},f}})),me={};L(me,{default:function(){return be}});var be,xe=U((function(){N(),be={}})),Se=C((function(e,t){N();var n=(ue(),T(oe)),r=(de(),T(le)).Stream,i=we(),s=(xe(),T(me)),o="win32"===a.platform,u=a.stderr;var c=["host","port","database","user","password"],f=c.length,h=c[f-1];function l(){if(u instanceof r&&!0===u.writable){var e=Array.prototype.slice.call(arguments).concat("\n");u.write(s.format.apply(s,e))}}Object.defineProperty(t.exports,"isWin",{get:function(){return o},set:function(e){o=e}}),t.exports.warnTo=function(e){var t=u;return u=e,t},t.exports.getFileName=function(e){var t=e||a.env;return t.PGPASSFILE||(o?n.join(t.APPDATA||"./","postgresql","pgpass.conf"):n.join(t.HOME||"./",".pgpass"))},t.exports.usePgPass=function(e,t){return!Object.prototype.hasOwnProperty.call(a.env,"PGPASSWORD")&&(!!o||(t=t||"<unkn>",function(e){return 32768==(61440&e)}(e.mode)?!(63&e.mode)||(l('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',t),!1):(l('WARNING: password file "%s" is not a plain file',t),!1)))};var p=t.exports.match=function(e,t){return c.slice(0,-1).reduce((function(n,r,i){return 1==i&&Number(e[r]||5432)===Number(t[r])?n&&!0:n&&("*"===t[r]||t[r]===e[r])}),!0)};t.exports.getPassword=function(e,t,n){var r,s=t.pipe(i());var o=function(e){t.destroy(),l("WARNING: error on reading file: %s",e),n(void 0)};t.on("error",o),s.on("data",(function(t){var n=d(t);n&&y(n)&&p(e,n)&&(r=n[h],s.end())})).on("end",(function(){t.destroy(),n(r)})).on("error",o)};var d=t.exports.parseLine=function(e){if(e.length<11||e.match(/^\s+#/))return null;for(var t="",n="",r=0,i=0,s={},o=function(t,n,r){var i=e.substring(n,r);Object.hasOwnProperty.call(a.env,"PGPASS_NO_DEESCAPE")||(i=i.replace(/\\([:\\])/g,"$1")),s[c[t]]=i},u=0;u<e.length-1;u+=1){if(t=e.charAt(u+1),n=e.charAt(u),r==f-1){o(r,i);break}u>=0&&":"==t&&"\\"!==n&&(o(r,i,u+1),i=u+2,r+=1)}return s=Object.keys(s).length===f?s:null},y=t.exports.isValidEntry=function(e){for(var t={0:function(e){return e.length>0},1:function(e){return"*"===e||(e=Number(e),isFinite(e)&&e>0&&e<9007199254740992&&Math.floor(e)===e)},2:function(e){return e.length>0},3:function(e){return e.length>0},4:function(e){return e.length>0}},n=0;n<c.length;n+=1){if(!(0,t[n])(e[c[n]]||""))return!1}return!0}})),Ee=C((function(e,t){N();ue(),T(oe);var n=(he(),T(ce)),r=Se();t.exports=function(e,t){var i=r.getFileName();n.stat(i,(function(s,o){if(s||!r.usePgPass(o,i))return t(void 0);var a=n.createReadStream(i);r.getPassword(e,a,t)}))},t.exports.warnTo=r.warnTo})),Ae=C((function(e,t){N();var n=ne();function r(e){this._types=e||n,this.text={},this.binary={}}r.prototype.getOverrides=function(e){switch(e){case"text":return this.text;case"binary":return this.binary;default:return{}}},r.prototype.setTypeParser=function(e,t,n){"function"==typeof t&&(n=t,t="text"),this.getOverrides(t)[e]=n},r.prototype.getTypeParser=function(e,t){return t=t||"text",this.getOverrides(t)[e]||this._types.getTypeParser(e,t)},t.exports=r})),_e={};L(_e,{default:function(){return ke}});var ke,Ue=U((function(){N(),ke={}})),Ce={};function Le(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new URL(e).protocol,r="http:"+e.substring(n.length),i=new URL(r),s=i.username,o=i.password,a=i.hostname,u=i.port,c=i.pathname,f=i.search,h=i.searchParams,l=i.hash;return{href:e,protocol:n,auth:s+":"+(o=decodeURIComponent(o)),username:s,password:o,hostname:a,port:u,pathname:c,search:f,query:t?Object.fromEntries(h.entries()):f,hash:l}}L(Ce,{parse:function(){return Le}});var Ie=U((function(){N()})),Me=C((function(e,t){N();var n=(Ie(),T(Ce)),r=(he(),T(ce));function i(e){if("/"===e.charAt(0))return{host:(i=e.split(" "))[0],database:i[1]};var t=n.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(e)?encodeURI(e).replace(/\%25(\d\d)/g,"%$1"):e,!0),i=t.query;for(var s in i)Array.isArray(i[s])&&(i[s]=i[s][i[s].length-1]);var o=(t.auth||":").split(":");if(i.user=o[0],i.password=o.splice(1).join(":"),i.port=t.port,"socket:"==t.protocol)return i.host=decodeURI(t.pathname),i.database=t.query.db,i.client_encoding=t.query.encoding,i;i.host||(i.host=t.hostname);var a=t.pathname;if(!i.host&&a&&/^%2f/i.test(a)){var u=a.split("/");i.host=decodeURIComponent(u[0]),a=u.splice(1).join("/")}switch(a&&"/"===a.charAt(0)&&(a=a.slice(1)||null),i.database=a&&decodeURI(a),("true"===i.ssl||"1"===i.ssl)&&(i.ssl=!0),"0"===i.ssl&&(i.ssl=!1),(i.sslcert||i.sslkey||i.sslrootcert||i.sslmode)&&(i.ssl={}),i.sslcert&&(i.ssl.cert=r.readFileSync(i.sslcert).toString()),i.sslkey&&(i.ssl.key=r.readFileSync(i.sslkey).toString()),i.sslrootcert&&(i.ssl.ca=r.readFileSync(i.sslrootcert).toString()),i.sslmode){case"disable":i.ssl=!1;break;case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":i.ssl.rejectUnauthorized=!1}return i}t.exports=i,i.parse=i})),Te=C((function(e,t){N();var n=(Ue(),T(_e)),r=re(),i=Me().parse,s=function(e,t,n){return void 0===n?n=a.env["PG"+e.toUpperCase()]:!1===n||(n=a.env[n]),t[e]||n||r[e]},o=function(e){return"'"+(""+e).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},u=function(e,t,n){var r=t[n];null!=r&&e.push(n+"="+o(r))},c=function(){function e(t){y(this,e),(t="string"==typeof t?i(t):t||{}).connectionString&&(t=Object.assign({},t,i(t.connectionString))),this.user=s("user",t),this.database=s("database",t),void 0===this.database&&(this.database=this.user),this.port=parseInt(s("port",t),10),this.host=s("host",t),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:s("password",t)}),this.binary=s("binary",t),this.options=s("options",t),this.ssl=typeof t.ssl>"u"?function(){switch(a.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return r.ssl}():t.ssl,"string"==typeof this.ssl&&"true"===this.ssl&&(this.ssl=!0),"no-verify"===this.ssl&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=s("client_encoding",t),this.replication=s("replication",t),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=s("application_name",t,"PGAPPNAME"),this.fallback_application_name=s("fallback_application_name",t,!1),this.statement_timeout=s("statement_timeout",t,!1),this.lock_timeout=s("lock_timeout",t,!1),this.idle_in_transaction_session_timeout=s("idle_in_transaction_session_timeout",t,!1),this.query_timeout=s("query_timeout",t,!1),void 0===t.connectionTimeoutMillis?this.connect_timeout=a.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(t.connectionTimeoutMillis/1e3),!1===t.keepAlive?this.keepalives=0:!0===t.keepAlive&&(this.keepalives=1),"number"==typeof t.keepAliveInitialDelayMillis&&(this.keepalives_idle=Math.floor(t.keepAliveInitialDelayMillis/1e3))}return v(e,[{key:"getLibpqConnectionString",value:function(e){var t=[];u(t,this,"user"),u(t,this,"password"),u(t,this,"port"),u(t,this,"application_name"),u(t,this,"fallback_application_name"),u(t,this,"connect_timeout"),u(t,this,"options");var r="object"==typeof this.ssl?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(u(t,r,"sslmode"),u(t,r,"sslca"),u(t,r,"sslkey"),u(t,r,"sslcert"),u(t,r,"sslrootcert"),this.database&&t.push("dbname="+o(this.database)),this.replication&&t.push("replication="+o(this.replication)),this.host&&t.push("host="+o(this.host)),this.isDomainSocket)return e(null,t.join(" "));this.client_encoding&&t.push("client_encoding="+o(this.client_encoding)),n.lookup(this.host,(function(n,r){return n?e(n,null):(t.push("hostaddr="+o(r)),e(null,t.join(" ")))}))}}]),e}();t.exports=c})),Re=C((function(e,t){N();var n=ne(),r=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,i=function(){function e(t,n){y(this,e),this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=n,this.RowCtor=null,this.rowAsArray="array"===t,this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}return v(e,[{key:"addCommandComplete",value:function(e){var t;(t=e.text?r.exec(e.text):r.exec(e.command))&&(this.command=t[1],t[3]?(this.oid=parseInt(t[2],10),this.rowCount=parseInt(t[3],10)):t[2]&&(this.rowCount=parseInt(t[2],10)))}},{key:"_parseRowAsArray",value:function(e){for(var t=new Array(e.length),n=0,r=e.length;n<r;n++){var i=e[n];t[n]=null!==i?this._parsers[n](i):null}return t}},{key:"parseRow",value:function(e){for(var t={},n=0,r=e.length;n<r;n++){var i=e[n],s=this.fields[n].name;t[s]=null!==i?this._parsers[n](i):null}return t}},{key:"addRow",value:function(e){this.rows.push(e)}},{key:"addFields",value:function(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));for(var t=0;t<e.length;t++){var r=e[t];this._types?this._parsers[t]=this._types.getTypeParser(r.dataTypeID,r.format||"text"):this._parsers[t]=n.getTypeParser(r.dataTypeID,r.format||"text")}}}]),e}();t.exports=i})),Pe=C((function(e,t){N();var n=D().EventEmitter,r=Re(),i=ie(),s=function(e){w(n,e);var t=m(n);function n(e,s,o){var u;return y(this,n),u=t.call(this),e=i.normalizeQueryConfig(e,s,o),u.text=e.text,u.values=e.values,u.rows=e.rows,u.types=e.types,u.name=e.name,u.binary=e.binary,u.portal=e.portal||"",u.callback=e.callback,u._rowMode=e.rowMode,a.domain&&e.callback&&(u.callback=a.domain.bind(e.callback)),u._result=new r(u._rowMode,u.types),u._results=u._result,u.isPreparedStatement=!1,u._canceledDueToError=!1,u._promise=null,u}return v(n,[{key:"requiresPreparation",value:function(){return!(!this.name&&!this.rows)||!(!this.text||!this.values)&&this.values.length>0}},{key:"_checkForMultirow",value:function(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new r(this._rowMode,this.types),this._results.push(this._result))}},{key:"handleRowDescription",value:function(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}},{key:"handleDataRow",value:function(e){var t;if(!this._canceledDueToError){try{t=this._result.parseRow(e.fields)}catch(n){return void(this._canceledDueToError=n)}this.emit("row",t,this._result),this._accumulateRows&&this._result.addRow(t)}}},{key:"handleCommandComplete",value:function(e,t){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&t.sync()}},{key:"handleEmptyQuery",value:function(e){this.rows&&e.sync()}},{key:"handleError",value:function(e,t){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}},{key:"handleReadyForQuery",value:function(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(t){a.nextTick((function(){throw t}))}this.emit("end",this._results)}},{key:"submit",value:function(e){if("string"!=typeof this.text&&"string"!=typeof this.name)return new Error("A query must have either text or a name. Supplying neither is unsupported.");var t=e.parsedStatements[this.name];return this.text&&t&&this.text!==t?new Error("Prepared statements must be unique - '".concat(this.name,"' was used for a different statement")):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}},{key:"hasBeenParsed",value:function(e){return this.name&&e.parsedStatements[this.name]}},{key:"handlePortalSuspended",value:function(e){this._getRows(e,this.rows)}},{key:"_getRows",value:function(e,t){e.execute({portal:this.portal,rows:t}),t?e.flush():e.sync()}},{key:"prepare",value:function(e){this.isPreparedStatement=!0,this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:i.prepareValue})}catch(t){return void this.handleError(t,e)}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}},{key:"handleCopyInResponse",value:function(e){e.sendCopyFail("No source stream defined")}},{key:"handleCopyData",value:function(e,t){}}]),n}(n);t.exports=s}));function Oe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length&&t[0]instanceof Uint8Array)return t[0];for(var r=t.reduce((function(e,t){return e+t.length}),0),i=new Uint8Array(r),s=0,o=0,a=t;o<a.length;o++){var u=a[o];i.set(u,s),s+=u.length}return i}function Be(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Ne(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=new bt(1024);i.writeUint8(22,0),i.writeUint16(769,0);var o=i.writeLengthUint16();i.writeUint8(1,0);var a=i.writeLengthUint24();i.writeUint16(771,0),s.getRandomValues(i.subarray(32));var u=i.writeLengthUint8(0);i.writeBytes(n),u();var c=i.writeLengthUint16(0);i.writeUint16(4865,0),c();var f=i.writeLengthUint8(0);i.writeUint8(0,0),f();var h=i.writeLengthUint16(0);if(r){i.writeUint16(0,0);var l=i.writeLengthUint16(0),p=i.writeLengthUint16(0);i.writeUint8(0,0);var d=i.writeLengthUint16(0);i.writeUTF8String(e),d(),p(),l()}i.writeUint16(11,0);var y=i.writeLengthUint16(0),v=i.writeLengthUint8(0);i.writeUint8(0,0),v(),y(),i.writeUint16(10,0);var g=i.writeLengthUint16(0),w=i.writeLengthUint16(0);i.writeUint16(23,0),w(),g(),i.writeUint16(13,0);var m=i.writeLengthUint16(0),b=i.writeLengthUint16(0);i.writeUint16(1027,0),i.writeUint16(2052,0),b(),m(),i.writeUint16(43,0);var x=i.writeLengthUint16(0),S=i.writeLengthUint8(0);i.writeUint16(772,0),S(),x(),i.writeUint16(51,0);var E=i.writeLengthUint16(0),A=i.writeLengthUint16(0);i.writeUint16(23,0);var _=i.writeLengthUint16(0);return i.writeBytes(new Uint8Array(t)),_(),A(),E(),h(),a(),o(),i}function De(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return d(e).map((function(e){return e.toString(16).padStart(2,"0")})).join(t)}function je(e,t){var n,r,i=e.expectLength(e.remaining()),s=p(i,1)[0];e.expectUint8(2,0);var o=e.expectLengthUint24(0),a=p(o,1)[0];if(e.expectUint16(771,0),Be(e.readBytes(32),[207,33,173,116,229,154,97,17,190,29,140,2,30,101,184,145,194,162,17,22,122,187,140,94,7,158,9,226,200,168,51,156]))throw new Error("Unexpected HelloRetryRequest");e.expectUint8(t.length,0),e.expectBytes(t,0),e.expectUint16(4865,0),e.expectUint8(0,0);for(var u=e.expectLengthUint16(0),c=p(u,2),f=c[0],h=c[1];h()>0;){var l=e.readUint16(0),d=e.expectLengthUint16(0),y=p(d,1)[0];if(43===l)e.expectUint16(772,0),r=!0;else{if(51!==l)throw new Error("Unexpected extension 0x".concat(De([l])));e.expectUint16(23,0),e.expectUint16(65),n=e.readBytes(65)}y()}if(f(),a(),s(),!0!==r)throw new Error("No TLS version provided");if(void 0===n)throw new Error("No key provided");return n}function Qe(e,t){return Fe.apply(this,arguments)}function Fe(){return Fe=l(h().mark((function e(t,n){var r,i,s,o,a,u,c,f=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>2&&void 0!==f[2]?f[2]:xt,e.next=3,t(5);case 3:if(void 0!==(i=e.sent)){e.next=6;break}return e.abrupt("return");case 6:if(!(i.length<5)){e.next=8;break}throw new Error("TLS record header truncated");case 8:if(s=new bt(i),!((o=s.readUint8())<20||o>24)){e.next=11;break}throw new Error("Illegal TLS record type 0x".concat(o.toString(16)));case 11:if(void 0===n||o===n){e.next=13;break}throw new Error("Unexpected TLS record type 0x".concat(o.toString(16).padStart(2,"0")," (expected 0x").concat(n.toString(16).padStart(2,"0"),")"));case 13:if(a=s.readUint16(0),!([769,770,771].indexOf(a)<0)){e.next=16;break}throw new Error("Unsupported TLS record version 0x".concat(a.toString(16).padStart(4,"0")));case 16:if(!((u=s.readUint16(0))>r)){e.next=19;break}throw new Error("Record too long: ".concat(u," bytes"));case 19:return e.next=21,t(u);case 21:if(!(void 0===(c=e.sent)||c.length<u)){e.next=24;break}throw new Error("TLS record content truncated");case 24:return e.abrupt("return",{headerData:i,header:s,type:o,version:a,length:u,content:c});case 25:case"end":return e.stop()}}),e)}))),Fe.apply(this,arguments)}function He(e,t,n){return qe.apply(this,arguments)}function qe(){return(qe=l(h().mark((function e(t,n,r){var i,s,o,a,u,c,f,l,d;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe(t,23,St);case 2:if(void 0!==(i=e.sent)){e.next=5;break}return e.abrupt("return");case 5:return s=new bt(i.content),o=s.expectLength(s.remaining()),a=p(o,1),u=a[0],s.skip(i.length-16,0),s.skip(16,0),u(),e.next=9,n.process(i.content,16,i.headerData);case 9:for(c=e.sent,f=c.length-1;0===c[f];)f-=1;if(!(f<0)){e.next=14;break}throw new Error("Decrypted message has no record type indicator (all zeroes)");case 14:if(l=c[f],d=c.subarray(0,f),21===l&&2===d.length&&1===d[0]&&0===d[1]){e.next=21;break}if(22!==l||4!==d[0]){e.next=18;break}return e.abrupt("return",He(t,n,r));case 18:if(void 0===r||l===r){e.next=20;break}throw new Error("Unexpected TLS record type 0x".concat(l.toString(16).padStart(2,"0")," (expected 0x").concat(r.toString(16).padStart(2,"0"),")"));case 20:return e.abrupt("return",d);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(e,t,n){return Ve.apply(this,arguments)}function Ve(){return(Ve=l(h().mark((function e(t,n,r){var i,s,o,a,u,c,f,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Oe(t,[r]),5,s=i.length+16,(o=new bt(5+s)).writeUint8(23,0),o.writeUint16(771,0),o.writeUint16(s,"".concat(s," bytes follow")),a=o.expectLength(s),u=p(a,1),c=u[0],f=o.array(),e.next=8,n.process(i,16,f);case 8:return l=e.sent,e.abrupt("return",(o.writeBytes(l.subarray(0,l.length-16)),o.writeBytes(l.subarray(l.length-16)),c(),o.array()));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(e,t,n){return We.apply(this,arguments)}function We(){return(We=l(h().mark((function e(t,n,r){var i,s,o,a,u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Math.ceil(t.length/xt),s=[],o=0;case 2:if(!(o<i)){e.next=11;break}return a=t.subarray(o*xt,(o+1)*xt),e.next=6,Ke(a,n,r);case 6:u=e.sent,s.push(u);case 8:o++,e.next=2;break;case 11:return e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(e,t,n){return ze.apply(this,arguments)}function ze(){return(ze=l(h().mark((function e(t,n,r){var i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Et.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-".concat(r)}},!1,["sign"]);case 2:return i=e.sent,e.t0=Uint8Array,e.next=6,Et.sign("HMAC",i,n);case 6:return e.t1=e.sent,s=new e.t0(e.t1),e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(e,t,n,r){return Je.apply(this,arguments)}function Je(){return(Je=l(h().mark((function e(t,n,r,i){var s,o,a,u,c,f,l,p,d;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=i>>3,o=Math.ceil(r/s),a=new Uint8Array(o*s),e.next=5,Et.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-".concat(i)}},!1,["sign"]);case 5:u=e.sent,c=new Uint8Array(0),f=0;case 8:if(!(f<o)){e.next=18;break}return l=Oe(c,n,[f+1]),e.next=12,Et.sign("HMAC",u,l);case 12:p=e.sent,d=new Uint8Array(p),a.set(d,s*f),c=d;case 15:f++,e.next=8;break;case 18:return e.abrupt("return",a.subarray(0,r));case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(e,t,n,r,i){return $e.apply(this,arguments)}function $e(){return($e=l(h().mark((function e(t,n,r,i,s){var o,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=At.encode(n),a=Oe([(65280&i)>>8,255&i],[_t.length+o.length],_t,o,[r.length],r),e.abrupt("return",Ye(t,a,i,s));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function et(e,t,n,r,i){return tt.apply(this,arguments)}function tt(){return(tt=l(h().mark((function e(t,n,r,i,s){var o,a,u,c,f,l,p,d,y,v,g,w,m,b,x,S,E,A;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=i>>3,a=new Uint8Array(o),e.next=4,Et.importKey("raw",t,{name:"ECDH",namedCurve:"P-256"},!1,[]);case 4:return u=e.sent,e.next=7,Et.deriveBits({name:"ECDH",public:u},n,256);case 7:return c=e.sent,f=new Uint8Array(c),e.next=11,Et.digest("SHA-256",r);case 11:return l=e.sent,p=new Uint8Array(l),e.next=15,Ze(new Uint8Array(1),a,i);case 15:return d=e.sent,e.next=18,Et.digest("SHA-".concat(i),new Uint8Array(0));case 18:return y=e.sent,v=new Uint8Array(y),e.next=22,Xe(d,"derived",v,o,i);case 22:return g=e.sent,e.next=25,Ze(g,f,i);case 25:return w=e.sent,e.next=28,Xe(w,"c hs traffic",p,o,i);case 28:return m=e.sent,e.next=31,Xe(w,"s hs traffic",p,o,i);case 31:return b=e.sent,e.next=34,Xe(m,"key",new Uint8Array(0),s,i);case 34:return x=e.sent,e.next=37,Xe(b,"key",new Uint8Array(0),s,i);case 37:return S=e.sent,e.next=40,Xe(m,"iv",new Uint8Array(0),12,i);case 40:return E=e.sent,e.next=43,Xe(b,"iv",new Uint8Array(0),12,i);case 43:return A=e.sent,e.abrupt("return",{serverHandshakeKey:S,serverHandshakeIV:A,clientHandshakeKey:x,clientHandshakeIV:E,handshakeSecret:w,clientSecret:m,serverSecret:b});case 45:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nt(e,t,n,r){return rt.apply(this,arguments)}function rt(){return(rt=l(h().mark((function e(t,n,r,i){var s,o,a,u,c,f,l,p,d,y,v,g;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r>>3,o=new Uint8Array(s),e.next=4,Et.digest("SHA-".concat(r),new Uint8Array(0));case 4:return a=e.sent,u=new Uint8Array(a),e.next=8,Xe(t,"derived",u,s,r);case 8:return c=e.sent,e.next=11,Ze(c,o,r);case 11:return f=e.sent,e.next=14,Xe(f,"c ap traffic",n,s,r);case 14:return l=e.sent,e.next=17,Xe(f,"s ap traffic",n,s,r);case 17:return p=e.sent,e.next=20,Xe(l,"key",new Uint8Array(0),i,r);case 20:return d=e.sent,e.next=23,Xe(p,"key",new Uint8Array(0),i,r);case 23:return y=e.sent,e.next=26,Xe(l,"iv",new Uint8Array(0),12,r);case 26:return v=e.sent,e.next=29,Xe(p,"iv",new Uint8Array(0),12,r);case 29:return g=e.sent,e.abrupt("return",{serverApplicationKey:y,serverApplicationIV:g,clientApplicationKey:d,clientApplicationIV:v});case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function it(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:61===e?64:void 0}function st(e){for(var t=e.length,n=0,r=0,i=64,s=64,o=64,a=64,u=new Uint8Array(.75*t);n<t;)i=it(e.charCodeAt(n++)),s=it(e.charCodeAt(n++)),o=it(e.charCodeAt(n++)),a=it(e.charCodeAt(n++)),u[r++]=i<<2|s>>4,u[r++]=(15&s)<<4|o>>2,u[r++]=(3&o)<<6|a;var c=64===s?0:64===o?2:64===a?1:0;return u.subarray(0,r-c)}function ot(e,t){var n={};e.expectUint8(Lt,0);for(var r=e.expectASN1Length(0),i=p(r,2),s=i[0],o=i[1];o()>0;){var a;e.expectUint8(It,0);var u=e.expectASN1Length(0),c=p(u,1)[0];e.expectUint8(Lt,0);var f=e.expectASN1Length(0),h=p(f,1)[0];e.expectUint8(Mt,0);var l=e.readASN1OID(),d=null!==(a=Ot[l])&&void 0!==a?a:l,y=e.readUint8();if(y!==Tt&&y!==Rt)throw new Error("Unexpected item type in certificate ".concat(t,": 0x").concat(De([y])));var v=e.expectASN1Length(0),g=p(v,2),w=g[0],m=g[1],b=e.readUTF8String(m());if(w(),h(),c(),void 0!==n[d])throw new Error("Duplicate OID ".concat(d," in certificate ").concat(t));n[d]=b}return s(),n}function at(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object.values(e).forEach((function(e){t="string"==typeof e?[].concat(d(t),[e]):at(e,t)})),t}function ut(e){return at(e).join(" / ")}function ct(e,t,n,r,i){return ft.apply(this,arguments)}function ft(){return(ft=l(h().mark((function e(t,n,r,i,s){var o,a,u,c,f,l,d,y,v,g,w,m,b,x,S,E,A;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.expectUint8(Lt,0),o=t.expectASN1Length(0),a=p(o,1),u=a[0],t.expectUint8(Ct,0),c=t.expectASN1Length(0),f=p(c,2),l=f[0],d=f[1],y=t.readBytes(d()),l(),t.expectUint8(Ct,0),v=t.expectASN1Length(0),g=p(v,2),w=g[0],m=g[1],b=t.readBytes(m()),w(),u(),x=function(e,t){return e.length>t?e.subarray(e.length-t):e.length<t?Oe(new Uint8Array(t-e.length),e):e},E=Oe(x(y,S="P-256"===i?32:48),x(b,S)),e.next=12,Et.importKey("spki",n,{name:"ECDSA",namedCurve:i},!1,["verify"]);case 12:return A=e.sent,e.next=15,Et.verify({name:"ECDSA",hash:s},A,E,r);case 15:if(e.t0=e.sent,e.t1=!0,e.t0===e.t1){e.next=19;break}throw new Error("ECDSA-SECP256R1-SHA256 certificate verify failed");case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ht(e,t,n){return lt.apply(this,arguments)}function lt(){return(lt=l(h().mark((function e(t,n,r){var i,s,o,a,u,c,f,l,p,d;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=b(n);try{for(s.s();!(o=s.n()).done;)o.value}catch(y){s.e(y)}finally{s.f()}if(void 0!==(a=n[0]).subjectAltNameMatchingHost(t)){e.next=5;break}throw new Error("No matching subjectAltName for ".concat(t));case 5:if(a.isValidAtMoment()){e.next=7;break}throw new Error("End-user certificate is not valid now");case 7:if(null!==(i=a.extKeyUsage)&&void 0!==i&&i.serverTls){e.next=9;break}throw new Error("End-user certificate has no TLS server extKeyUsage");case 9:u=!1,c=b(r);try{for(c.s();!(f=c.n()).done;)f.value}catch(y){c.e(y)}finally{c.f()}l=h().mark((function e(){var t,i,s,o,a,c,f,l,d,y,v,g,w;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n[p],void 0!==(o=s.authorityKeyIdentifier)){e.next=3;break}throw new Error("Certificates without an authorityKeyIdentifier are not supported");case 3:if(a=r.find((function(e){return void 0!==e.subjectKeyIdentifier&&Be(e.subjectKeyIdentifier,o)})),void 0===a&&(a=n[p+1]),void 0!==a){e.next=6;break}throw new Error("Ran out of certificates before reaching trusted root");case 6:if(c=a instanceof Dt,!0===a.isValidAtMoment()){e.next=9;break}throw new Error("Signing certificate is not valid now");case 9:if(!0===(null===(t=a.keyUsage)||void 0===t?void 0:t.usages.has("digitalSignature"))){e.next=11;break}throw new Error("Signing certificate keyUsage does not include digital signatures");case 11:if(!0===(null===(i=a.basicConstraints)||void 0===i?void 0:i.ca)){e.next=13;break}throw new Error("Signing certificate basicConstraints do not indicate a CA certificate");case 13:if(!(void 0!==(f=a.basicConstraints.pathLength)&&f<p)){e.next=16;break}throw new Error("Exceeded certificate path length");case 16:if("1.2.840.10045.4.3.2"!==s.algorithm&&"1.2.840.10045.4.3.3"!==s.algorithm){e.next=25;break}if(l="1.2.840.10045.4.3.2"===s.algorithm?"SHA-256":"SHA-384",d=a.publicKey.identifiers,void 0!==(y=d.includes("1.2.840.10045.3.1.7")?"P-256":d.includes("1.3.132.0.34")?"P-384":void 0)){e.next=20;break}throw new Error("Unsupported signing key curve");case 20:return v=new Ut(s.signature),e.next=23,ct(v,a.publicKey.all,s.signedData,y,l);case 23:case 36:e.next=39;break;case 25:if("1.2.840.113549.1.1.11"!==s.algorithm&&"1.2.840.113549.1.1.12"!==s.algorithm){e.next=38;break}return g="1.2.840.113549.1.1.11"===s.algorithm?"SHA-256":"SHA-384",e.next=29,Et.importKey("spki",a.publicKey.all,{name:"RSASSA-PKCS1-v1_5",hash:g},!1,["verify"]);case 29:return w=e.sent,e.next=32,Et.verify({name:"RSASSA-PKCS1-v1_5"},w,s.signature,s.signedData);case 32:if(e.t0=e.sent,e.t1=!0,e.t0===e.t1){e.next=36;break}throw new Error("RSASSA_PKCS1-v1_5-SHA256 certificate verify failed");case 38:throw new Error("Unsupported signing algorithm");case 39:if(!c){e.next=42;break}return u=!0,e.abrupt("return","break");case 42:case"end":return e.stop()}}),e)})),p=0,d=n.length;case 14:if(!(p<d)){e.next=22;break}return e.delegateYield(l(),"t0",16);case 16:if("break"!==e.t0){e.next=19;break}return e.abrupt("break",22);case 19:p++,e.next=14;break;case 22:return e.abrupt("return",u);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pt(e,t,n,r,i){return dt.apply(this,arguments)}function dt(){return(dt=l(h().mark((function e(t,n,r,i,s){var o,a,u,c,f,l,d,y,v,g,w,m,b,x,S,E,A,_,k,U,C,L,I,M,T,R,P,O,B,N,D,j,Q,F,H,q,K,V,G,W,Z,z,Y,J,X,$,ee,te,ne,re,ie,se,oe,ae,ue,ce,fe,he,le,pe,de,ye,ve,ge,we,me,be,xe,Se;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Ut,e.next=3,n();case 3:e.t1=e.sent,(o=new e.t0(e.t1)).expectUint8(8,0),a=o.expectLengthUint24(),u=p(a,1),c=u[0],f=o.expectLengthUint16(0),l=p(f,2),d=l[0],y=l[1];case 7:if(!(y()>0)){e.next=21;break}if(0!==(v=o.readUint16(0))){e.next=13;break}o.expectUint16(0,0),e.next=19;break;case 13:if(10!==v){e.next=18;break}g=o.expectLengthUint16("groups data"),w=p(g,2),m=w[0],b=w[1],o.skip(b(),0),m(),e.next=19;break;case 18:throw new Error("Unsupported server encrypted extension type 0x".concat(De([v]).padStart(4,"0")));case 19:e.next=7;break;case 21:if(d(),c(),e.t2=0===o.remaining(),!e.t2){e.next=30;break}return e.t3=o,e.next=28,n();case 28:e.t4=e.sent,e.t3.extend.call(e.t3,e.t4);case 30:if(x=!1,13!==(S=o.readUint8())){e.next=47;break}if(x=!0,E=o.expectLengthUint24("certificate request data"),A=p(E,1),_=A[0],o.expectUint8(0,0),k=o.expectLengthUint16("certificate request extensions"),U=p(k,2),C=U[0],L=U[1],o.skip(L(),0),C(),_(),e.t5=0===o.remaining(),!e.t5){e.next=46;break}return e.t6=o,e.next=44,n();case 44:e.t7=e.sent,e.t6.extend.call(e.t6,e.t7);case 46:S=o.readUint8();case 47:if(11===S){e.next=49;break}throw new Error("Unexpected handshake message type 0x".concat(De([S])));case 49:for(I=o.expectLengthUint24(0),M=p(I,1),T=M[0],o.expectUint8(0,0),R=o.expectLengthUint24(0),P=p(R,2),O=P[0],B=P[1],N=[];B()>0;)D=o.expectLengthUint24(0),j=p(D,1),Q=j[0],F=new Nt(o),N.push(F),Q(),H=o.expectLengthUint16(),q=p(H,2),K=q[0],V=q[1],o.subarray(V()),K();if(O(),T(),0!==N.length){e.next=55;break}throw new Error("No certificates supplied");case 55:return G=N[0],W=o.data.subarray(0,o.offset),Z=Oe(i,W),e.next=60,Et.digest("SHA-256",Z);case 60:if(z=e.sent,Y=new Uint8Array(z),J=Oe(jt.encode(" ".repeat(64)+"TLS 1.3, server CertificateVerify"),[0],Y),e.t8=0===o.remaining(),!e.t8){e.next=70;break}return e.t9=o,e.next=68,n();case 68:e.t10=e.sent,e.t9.extend.call(e.t9,e.t10);case 70:if(o.expectUint8(15,0),X=o.expectLengthUint24(0),$=p(X,1),ee=$[0],1027!==(te=o.readUint16())){e.next=79;break}return ne=o.expectLengthUint16(),re=p(ne,1),ie=re[0],e.next=76,ct(o,G.publicKey.all,J,"P-256","SHA-256");case 76:ie(),e.next=94;break;case 79:if(2052!==te){e.next=93;break}return se=o.expectLengthUint16(),oe=p(se,2),ae=oe[0],ue=oe[1],ce=o.subarray(ue()),ae(),e.next=84,Et.importKey("spki",G.publicKey.all,{name:"RSA-PSS",hash:"SHA-256"},!1,["verify"]);case 84:return fe=e.sent,e.next=87,Et.verify({name:"RSA-PSS",saltLength:32},fe,ce,J);case 87:if(e.t11=e.sent,e.t12=!0,e.t11===e.t12){e.next=91;break}throw new Error("RSA-PSS-RSAE-SHA256 certificate verify failed");case 91:e.next=94;break;case 93:throw new Error("Unsupported certificate verify signature type 0x".concat(De([te]).padStart(4,"0")));case 94:return ee(),he=o.data.subarray(0,o.offset),le=Oe(i,he),e.next=99,Xe(r,"finished",new Uint8Array(0),32,256);case 99:return pe=e.sent,e.next=102,Et.digest("SHA-256",le);case 102:return de=e.sent,e.next=105,Et.importKey("raw",pe,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);case 105:return ye=e.sent,e.next=108,Et.sign("HMAC",ye,de);case 108:if(ve=e.sent,ge=new Uint8Array(ve),e.t13=0===o.remaining(),!e.t13){e.next=117;break}return e.t14=o,e.next=115,n();case 115:e.t15=e.sent,e.t14.extend.call(e.t14,e.t15);case 117:if(o.expectUint8(20,0),we=o.expectLengthUint24(0),me=p(we,2),be=me[0],xe=me[1],Se=o.readBytes(xe()),be(),0===o.remaining()){e.next=121;break}throw new Error("Unexpected extra bytes in server handshake");case 121:if(!0===Be(Se,ge)){e.next=123;break}throw new Error("Invalid server verify hash");case 123:return e.next=125,ht(t,N,s);case 125:if(e.sent){e.next=127;break}throw new Error("Validated certificate chain did not end in a trusted root");case 127:return e.abrupt("return",[o.data,x]);case 128:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yt(e,t,n,r){return vt.apply(this,arguments)}function vt(){return vt=l(h().mark((function e(t,n,r,i){var o,a,u,c,f,y,v,g,w,m,b,x,S,E,A,_,k,U,C,L,I,M,T,R,P,O,B,N,D,j,Q,F,H,q,K,V,G,W,Z,z,Y,J,X,$,ee,te,ne,re,ie,se,oe,ae,ue,ce,fe,he,le=arguments;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=!(le.length>4&&void 0!==le[4])||le[4],a=le.length>5?le[5]:void 0,u=le.length>6?le[6]:void 0,le.length>7?le[7]:void 0,e.next=6,Et.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"]);case 6:return c=e.sent,e.next=9,Et.exportKey("raw",c.publicKey);case 9:if(f=e.sent,y=new Uint8Array(32),s.getRandomValues(y),v=Ne(t,f,y,o).array(),g=a?Oe(a,v):v,i(g),!u){e.next=19;break}return e.next=16,r(u.length);case 16:if((w=e.sent)&&Be(w,u)){e.next=19;break}throw new Error("Pre data did not match expectation");case 19:return e.next=21,Qe(r,22);case 21:if(void 0!==(m=e.sent)){e.next=24;break}throw new Error("Connection closed while awaiting server hello");case 24:return b=new bt(m.content),x=je(b,y),e.next=28,Qe(r,20);case 28:if(void 0!==(S=e.sent)){e.next=31;break}throw new Error("Connection closed awaiting server cipher change");case 31:return E=new bt(S.content),A=E.expectLength(1),_=p(A,1),k=_[0],E.expectUint8(1,0),k(),U=v.subarray(5),C=m.content,L=Oe(U,C),e.next=38,et(x,c.privateKey,L,256,16);case 38:return I=e.sent,e.next=41,Et.importKey("raw",I.serverHandshakeKey,{name:"AES-GCM"},!1,["decrypt"]);case 41:return M=e.sent,T=new kt("decrypt",M,I.serverHandshakeIV),e.next=45,Et.importKey("raw",I.clientHandshakeKey,{name:"AES-GCM"},!1,["encrypt"]);case 45:return R=e.sent,P=new kt("encrypt",R,I.clientHandshakeIV),O=function(){var e=l(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,He(r,T,22);case 2:if(void 0!==(t=e.sent)){e.next=5;break}throw new Error("Premature end of encrypted server handshake");case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=50,pt(t,O,I.serverSecret,L,n);case 50:return B=e.sent,N=p(B,2),D=N[0],j=N[1],(Q=new bt(6)).writeUint8(20,0),Q.writeUint16(771,0),F=Q.writeLengthUint16(),Q.writeUint8(1,0),F(),H=Q.array(),q=new Uint8Array(0),j&&((K=new bt(8)).writeUint8(11,0),V=K.writeLengthUint24("client certificate data"),K.writeUint8(0,0),K.writeUint24(0,0),V(),q=K.array()),G=Oe(L,D,q),e.next=63,Et.digest("SHA-256",G);case 63:return W=e.sent,Z=new Uint8Array(W),e.next=67,Xe(I.clientSecret,"finished",new Uint8Array(0),32,256);case 67:return z=e.sent,e.next=70,Et.importKey("raw",z,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);case 70:return Y=e.sent,e.next=73,Et.sign("HMAC",Y,Z);case 73:return J=e.sent,X=new Uint8Array(J),($=new bt(36)).writeUint8(20,0),ee=$.writeLengthUint24(0),$.writeBytes(X),ee(),te=$.array(),e.next=82,Ge(Oe(q,te),P,22);case 82:if(ne=e.sent,re=Z,!(q.length>0)){e.next=90;break}return ie=G.subarray(0,G.length-q.length),e.next=88,Et.digest("SHA-256",ie);case 88:se=e.sent,re=new Uint8Array(se);case 90:return e.next=92,nt(I.handshakeSecret,re,256,16);case 92:return oe=e.sent,e.next=95,Et.importKey("raw",oe.clientApplicationKey,{name:"AES-GCM"},!1,["encrypt"]);case 95:return ae=e.sent,ue=new kt("encrypt",ae,oe.clientApplicationIV),e.next=99,Et.importKey("raw",oe.serverApplicationKey,{name:"AES-GCM"},!1,["decrypt"]);case 99:return ce=e.sent,fe=new kt("decrypt",ce,oe.serverApplicationIV),he=!1,e.abrupt("return",[function(){if(!he){var e=Oe.apply(void 0,[H].concat(d(ne)));i(e),he=!0}return He(r,fe)},function(){var e=l(h().mark((function e(t){var n,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ge(t,ue,23);case 2:n=e.sent,r=he?Oe.apply(void 0,d(n)):Oe.apply(void 0,[H].concat(d(ne),d(n))),i(r),he=!0;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()]);case 103:case"end":return e.stop()}}),e)}))),vt.apply(this,arguments)}var gt,wt,mt,bt,xt,St,Et,At,_t,kt,Ut,Ct,Lt,It,Mt,Tt,Rt,Pt,Ot,Bt,Nt,Dt,jt,Qt,Ft,Ht=U((function(){N(),gt="\xb7\xb7 ",wt=new TextEncoder,mt=new TextDecoder,bt=function(){function e(t){y(this,e),R(this,"offset"),R(this,"dataView"),R(this,"data"),R(this,"comments"),R(this,"indents"),R(this,"indent"),this.offset=0,this.data="number"==typeof t?new Uint8Array(t):t,this.dataView=new DataView(this.data.buffer,this.data.byteOffset,this.data.byteLength),this.comments={},this.indents={},this.indent=0}return v(e,[{key:"extend",value:function(e){var t="number"==typeof e?new Uint8Array(e):e;this.data=Oe(this.data,t),this.dataView=new DataView(this.data.buffer,this.data.byteOffset,this.data.byteLength)}},{key:"remaining",value:function(){return this.data.length-this.offset}},{key:"subarray",value:function(e){return this.data.subarray(this.offset,this.offset+=e)}},{key:"skip",value:function(e,t){return this.offset+=e,t&&this.comment(t),this}},{key:"comment",value:function(e){arguments.length>1&&void 0!==arguments[1]||this.offset;throw new Error("No comments should be emitted outside of chatty mode")}},{key:"readBytes",value:function(e){return this.data.slice(this.offset,this.offset+=e)}},{key:"readUTF8String",value:function(e){var t=this.subarray(e);return mt.decode(t)}},{key:"readUTF8StringNullTerminated",value:function(){for(var e=this.offset;0!==this.data[e];)e++;var t=this.readUTF8String(e-this.offset);return this.expectUint8(0,"end of string"),t}},{key:"readUint8",value:function(e){var t=this.dataView.getUint8(this.offset);return this.offset+=1,t}},{key:"readUint16",value:function(e){var t=this.dataView.getUint16(this.offset);return this.offset+=2,t}},{key:"readUint24",value:function(e){return(this.readUint8()<<16)+this.readUint16()}},{key:"readUint32",value:function(e){var t=this.dataView.getUint32(this.offset);return this.offset+=4,t}},{key:"expectBytes",value:function(e,t){if(!Be(this.readBytes(e.length),e))throw new Error("Unexpected bytes")}},{key:"expectUint8",value:function(e,t){var n=this.readUint8();if(n!==e)throw new Error("Expected ".concat(e,", got ").concat(n))}},{key:"expectUint16",value:function(e,t){var n=this.readUint16();if(n!==e)throw new Error("Expected ".concat(e,", got ").concat(n))}},{key:"expectUint24",value:function(e,t){var n=this.readUint24();if(n!==e)throw new Error("Expected ".concat(e,", got ").concat(n))}},{key:"expectUint32",value:function(e,t){var n=this.readUint32();if(n!==e)throw new Error("Expected ".concat(e,", got ").concat(n))}},{key:"expectLength",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.offset,i=r+e;if(i>this.data.length)throw new Error("Expected length exceeds remaining data length");return this.indent+=n,this.indents[r]=this.indent,[function(){if(t.indent-=n,t.indents[t.offset]=t.indent,t.offset!==i)throw new Error("".concat(e," bytes expected but ").concat(t.offset-r," read"))},function(){return i-t.offset}]}},{key:"expectLengthUint8",value:function(e){var t=this.readUint8();return this.expectLength(t)}},{key:"expectLengthUint16",value:function(e){var t=this.readUint16();return this.expectLength(t)}},{key:"expectLengthUint24",value:function(e){var t=this.readUint24();return this.expectLength(t)}},{key:"expectLengthUint32",value:function(e){var t=this.readUint32();return this.expectLength(t)}},{key:"expectLengthUint8Incl",value:function(e){var t=this.readUint8();return this.expectLength(t-1)}},{key:"expectLengthUint16Incl",value:function(e){var t=this.readUint16();return this.expectLength(t-2)}},{key:"expectLengthUint24Incl",value:function(e){var t=this.readUint24();return this.expectLength(t-3)}},{key:"expectLengthUint32Incl",value:function(e){var t=this.readUint32();return this.expectLength(t-4)}},{key:"writeBytes",value:function(e){return this.data.set(e,this.offset),this.offset+=e.length,this}},{key:"writeUTF8String",value:function(e){var t=wt.encode(e);return this.writeBytes(t),this}},{key:"writeUTF8StringNullTerminated",value:function(e){var t=wt.encode(e);return this.writeBytes(t),this.writeUint8(0),this}},{key:"writeUint8",value:function(e,t){return this.dataView.setUint8(this.offset,e),this.offset+=1,this}},{key:"writeUint16",value:function(e,t){return this.dataView.setUint16(this.offset,e),this.offset+=2,this}},{key:"writeUint24",value:function(e,t){return this.writeUint8((16711680&e)>>16),this.writeUint16(65535&e,t),this}},{key:"writeUint32",value:function(e,t){return this.dataView.setUint32(this.offset,e),this.offset+=4,this}},{key:"_writeLengthGeneric",value:function(e,t,n){var r=this,i=this.offset;this.offset+=e;var s=this.offset;return this.indent+=1,this.indents[s]=this.indent,function(){var n=r.offset-(t?i:s);if(1===e)r.dataView.setUint8(i,n);else if(2===e)r.dataView.setUint16(i,n);else if(3===e)r.dataView.setUint8(i,(16711680&n)>>16),r.dataView.setUint16(i+1,65535&n);else{if(4!==e)throw new Error("Invalid length for length field: ".concat(e));r.dataView.setUint32(i,n)}r.indent-=1,r.indents[r.offset]=r.indent}}},{key:"writeLengthUint8",value:function(e){return this._writeLengthGeneric(1,!1,e)}},{key:"writeLengthUint16",value:function(e){return this._writeLengthGeneric(2,!1,e)}},{key:"writeLengthUint24",value:function(e){return this._writeLengthGeneric(3,!1,e)}},{key:"writeLengthUint32",value:function(e){return this._writeLengthGeneric(4,!1,e)}},{key:"writeLengthUint8Incl",value:function(e){return this._writeLengthGeneric(1,!0,e)}},{key:"writeLengthUint16Incl",value:function(e){return this._writeLengthGeneric(2,!0,e)}},{key:"writeLengthUint24Incl",value:function(e){return this._writeLengthGeneric(3,!0,e)}},{key:"writeLengthUint32Incl",value:function(e){return this._writeLengthGeneric(4,!0,e)}},{key:"array",value:function(){return this.data.subarray(0,this.offset)}},{key:"commentedString",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=void 0!==this.indents[0]?gt.repeat(this.indents[0]):"",r=null!==(e=this.indents[0])&&void 0!==e?e:0,i=t?this.data.length:this.offset,s=0;s<i;s++){n+=this.data[s].toString(16).padStart(2,"0")+" ";var o=this.comments[s+1];void 0!==this.indents[s+1]&&(r=this.indents[s+1]),o&&(n+=" ".concat(o,"\n").concat(gt.repeat(r)))}return n}}]),e}(),new RegExp("  .+|^(".concat(gt,")+"),"gm"),St=(xt=16384)+1+255,Et=s.subtle,At=new TextEncoder,_t=At.encode("tls13 "),1<<30,kt=function(){function e(t,n,r){y(this,e),R(this,"mode"),R(this,"key"),R(this,"initialIv"),R(this,"ivLength"),R(this,"currentIv"),R(this,"currentIvDataView"),R(this,"initialIvLast32"),R(this,"recordsDecrypted",0),this.mode=t,this.key=n,this.initialIv=r,this.ivLength=r.length,this.currentIv=r.slice(),this.currentIvDataView=new DataView(this.currentIv.buffer,this.currentIv.byteOffset,this.currentIv.byteLength),this.initialIvLast32=this.currentIvDataView.getUint32(this.ivLength-4)}return v(e,[{key:"process",value:function(){var e=l(h().mark((function e(t,n,r){var i,s,o,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1073741824!==this.recordsDecrypted){e.next=2;break}throw new Error("Cannot encrypt/decrypt any more records");case 2:return i=this.initialIvLast32^this.recordsDecrypted,this.currentIvDataView.setUint32(this.ivLength-4,i),this.recordsDecrypted+=1,s=n<<3,o={name:"AES-GCM",iv:this.currentIv,tagLength:s,additionalData:r},e.next=8,Et[this.mode](o,this.key,t);case 8:return a=e.sent,e.abrupt("return",new Uint8Array(a));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}(),Ut=function(e){w(n,e);var t=m(n);function n(){return y(this,n),t.apply(this,arguments)}return v(n,[{key:"readASN1Length",value:function(e){var t=this.readUint8();if(t<128)return t;var n=127&t;if(1===n)return this.readUint8(0);if(2===n)return this.readUint16(0);if(3===n)return this.readUint24(0);if(4===n)return this.readUint32(0);throw new Error("ASN.1 length fields are only supported up to 4 bytes (this one is ".concat(n," bytes)"))}},{key:"expectASN1Length",value:function(e){var t=this.readASN1Length(e);return this.expectLength(t)}},{key:"readASN1OID",value:function(){for(var e=this.expectASN1Length(0),t=p(e,2),n=t[0],r=t[1],i=this.readUint8(),s="".concat(Math.floor(i/40),".").concat(i%40);r()>0;){for(var o=0;;){var a=this.readUint8();if(o<<=7,o+=127&a,a<128)break}s+=".".concat(o)}return n(),s}},{key:"readASN1Boolean",value:function(){var e=this.expectASN1Length(0),t=p(e,2),n=t[0],r=(0,t[1])();if(1!==r)throw new Error("Boolean has weird length: ".concat(r));var i,s=this.readUint8();if(255===s)i=!0;else{if(0!==s)throw new Error("Boolean has weird value: 0x".concat(De([s])));i=!1}return n(),i}},{key:"readASN1UTCTime",value:function(){var e=this.expectASN1Length(0),t=p(e,2),n=t[0],r=t[1],i=this.readUTF8String(r()).match(/^(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z$/);if(!i)throw new Error("Unrecognised UTC time format in certificate validity");var s=p(i,7),o=s[1],a=s[2],u=s[3],c=s[4],f=s[5],h=s[6],l=parseInt(o,10),d=new Date("".concat(l+(l>=50?1900:2e3),"-").concat(a,"-").concat(u,"T").concat(c,":").concat(f,":").concat(h,"Z"));return n(),d}},{key:"readASN1BitString",value:function(){var e=this.expectASN1Length(0),t=p(e,2),n=t[0],r=t[1],i=this.readUint8(0),s=r(),o=this.readBytes(s);if(i>7)throw new Error("Invalid right pad value: ".concat(i));if(i>0){for(var a=8-i,u=s-1;u>0;u--)o[u]=255&o[u-1]<<a|o[u]>>>i;o[0]=o[0]>>>i}return n(),o}}]),n}(bt),1,Ct=2,Lt=48,It=49,Mt=6,Tt=19,Rt=12,23,5,4,3,163,Pt=128,Ot={"2.5.4.6":"C","2.5.4.10":"O","2.5.4.11":"OU","2.5.4.3":"CN","2.5.4.7":"L","2.5.4.8":"ST","2.5.4.12":"T","2.5.4.42":"GN","2.5.4.43":"I","2.5.4.4":"SN","1.2.840.113549.1.9.1":"E-mail"},Bt=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],Nt=function(){function e(t){var n=this;y(this,e),R(this,"serialNumber"),R(this,"algorithm"),R(this,"issuer"),R(this,"validityPeriod"),R(this,"subject"),R(this,"publicKey"),R(this,"signature"),R(this,"keyUsage"),R(this,"subjectAltNames"),R(this,"extKeyUsage"),R(this,"authorityKeyIdentifier"),R(this,"subjectKeyIdentifier"),R(this,"basicConstraints"),R(this,"signedData");var r=t instanceof Ut?t:new Ut(t);r.expectUint8(Lt,0);var i=r.expectASN1Length(0),s=p(i,1)[0],o=r.offset;r.expectUint8(Lt,0);var a=r.expectASN1Length(0),u=p(a,1)[0];r.expectBytes([160,3,2,1,2],0),r.expectUint8(Ct,0);var c=r.expectASN1Length(0),f=p(c,2),h=f[0],l=f[1];this.serialNumber=r.subarray(l()),h(),r.expectUint8(Lt,0);var d=r.expectASN1Length(0),v=p(d,2),g=v[0],w=v[1];r.expectUint8(Mt,0),this.algorithm=r.readASN1OID(),w()>0&&(r.expectUint8(5,0),r.expectUint8(0,0)),g(),this.issuer=ot(r,"issuer"),r.expectUint8(Lt,0);var m=r.expectASN1Length(0),b=p(m,1)[0];r.expectUint8(23,0);var x=r.readASN1UTCTime();r.expectUint8(23,0);var S=r.readASN1UTCTime();this.validityPeriod={notBefore:x,notAfter:S},b(),this.subject=ot(r,"subject");var E=r.offset;r.expectUint8(Lt,0);var A=r.expectASN1Length(0),_=p(A,1)[0];r.expectUint8(Lt,0);for(var k=r.expectASN1Length(0),U=p(k,2),C=U[0],L=U[1],I=[];L()>0;){var M=r.readUint8();if(M===Mt){var T=r.readASN1OID();I.push(T)}else 5===M&&r.expectUint8(0,0)}C(),r.expectUint8(3,0);var P=r.readASN1BitString();this.publicKey={identifiers:I,data:P,all:r.data.subarray(E,r.offset)},_(),r.expectUint8(163,0);var O=r.expectASN1Length(),B=p(O,1)[0];r.expectUint8(Lt,0);for(var N=r.expectASN1Length(0),D=p(N,2),j=D[0],Q=D[1],F=function(){r.expectUint8(Lt,0);var e=r.expectASN1Length(),t=p(e,2),i=t[0],s=t[1];r.expectUint8(Mt,0);var o=r.readASN1OID();if("2.5.29.17"===o){r.expectUint8(4,0);var a=r.expectASN1Length(0),u=p(a,1)[0];r.expectUint8(Lt,0);var c=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],r=e.expectASN1Length(0),i=p(r,2),s=i[0],o=i[1];o()>0;){var a=e.readUint8(0),u=e.expectASN1Length(0),c=p(u,2),f=c[0],h=c[1],l=void 0;l=a===(2|t)?e.readUTF8String(h()):e.readBytes(h()),n.push({name:l,type:a}),f()}return s(),n}(r,Pt);n.subjectAltNames=c.filter((function(e){return 130===e.type})).map((function(e){return e.name})),u()}else if("2.5.29.15"===o){r.expectUint8(1,0);var f=r.readASN1Boolean();r.expectUint8(4,0);var h=r.expectASN1Length(0),l=p(h,1)[0];r.expectUint8(3,0);var d=function(e){var t=e.length;if(t>4)throw new Error("Bit string length ".concat(t," would overflow JS bit operators"));for(var n=0,r=0,i=e.length-1;i>=0;i--)n|=e[i]<<r,r+=8;return n}(r.readASN1BitString()),y=new Set(Bt.filter((function(e,t){return d&1<<t})));l(),n.keyUsage={critical:f,usages:y}}else if("2.5.29.37"===o){n.extKeyUsage={},r.expectUint8(4,0);var v=r.expectASN1Length(0),g=p(v,1)[0];r.expectUint8(Lt,0);for(var w=r.expectASN1Length(0),m=p(w,2),b=m[0],x=m[1];x()>0;){r.expectUint8(Mt,0);var S=r.readASN1OID();"1.3.6.1.5.5.7.3.1"===S&&(n.extKeyUsage.serverTls=!0),"1.3.6.1.5.5.7.3.2"===S&&(n.extKeyUsage.clientTls=!0)}b(),g()}else if("2.5.29.35"===o){r.expectUint8(4,0);var E=r.expectASN1Length(0),A=p(E,1)[0];r.expectUint8(Lt,0);for(var _=r.expectASN1Length(0),k=p(_,2),U=k[0],C=k[1];C()>0;){var L=r.readUint8();if(128===L){var I=r.expectASN1Length(0),M=p(I,2),T=M[0],R=M[1];n.authorityKeyIdentifier=r.readBytes(R()),T()}else{if(129!==L&&130!==L)throw new Error("Unexpected data type in authorityKeyIdentifier certificate extension");var P=r.expectASN1Length(0),O=p(P,2),B=O[0],N=O[1];r.skip(N(),0),B()}}U(),A()}else if("2.5.29.14"===o){r.expectUint8(4,0);var D=r.expectASN1Length(0),j=p(D,1)[0];r.expectUint8(4,0);var Q=r.expectASN1Length(0),F=p(Q,2),H=F[0],q=F[1];n.subjectKeyIdentifier=r.readBytes(q()),H(),j()}else if("2.5.29.19"===o){var K,V=r.readUint8();if(1===V&&(K=r.readASN1Boolean(),V=r.readUint8()),4!==V)throw new Error("Unexpected type in certificate basic constraints");var G=r.expectASN1Length(0),W=p(G,1)[0];r.expectUint8(Lt,0);var Z,z,Y=r.expectASN1Length(),J=p(Y,2),X=J[0],$=J[1];if($()>0&&(r.expectUint8(1,0),Z=r.readASN1Boolean()),$()>0){r.expectUint8(Ct,0);var ee=r.readASN1Length(0);if(void 0===(z=1===ee?r.readUint8():2===ee?r.readUint16():3===ee?r.readUint24():void 0))throw new Error("Too many bytes in max path length in certificate basicConstraints")}X(),W(),n.basicConstraints={critical:K,ca:Z,pathLength:z}}else r.skip(s(),0);i()};Q()>0;)F();j(),B(),u(),this.signedData=r.data.subarray(o,r.offset),r.expectUint8(Lt,0);var H=r.expectASN1Length(0),q=p(H,2),K=q[0],V=q[1];r.expectUint8(Mt,0);var G=r.readASN1OID();if(V()>0&&(r.expectUint8(5,0),r.expectUint8(0,0)),K(),G!==this.algorithm)throw new Error("Certificate specifies different signature algorithms inside (".concat(this.algorithm,") and out (").concat(G,")"));r.expectUint8(3,0),this.signature=r.readASN1BitString(),s()}return v(e,[{key:"subjectAltNameMatchingHost",value:function(e){var t,n=/[.][^.]+[.][^.]+$/;return(null!==(t=this.subjectAltNames)&&void 0!==t?t:[]).find((function(t){var r=t,i=e;if(n.test(e)&&n.test(r)&&r.startsWith("*.")&&(r=r.slice(1),i=i.slice(i.indexOf("."))),r===i)return!0}))}},{key:"isValidAtMoment",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return e>=this.validityPeriod.notBefore&&e<=this.validityPeriod.notAfter}},{key:"description",value:function(){return"subject: "+Object.entries(this.subject).map((function(e){return e.join("=")})).join(", ")+(this.subjectAltNames?"\nsubject alt names: "+this.subjectAltNames.join(", "):"")+(this.subjectKeyIdentifier?"\nsubject key id: ".concat(De(this.subjectKeyIdentifier," ")):"")+"\nissuer: "+Object.entries(this.issuer).map((function(e){return e.join("=")})).join(", ")+(this.authorityKeyIdentifier?"\nauthority key id: ".concat(De(this.authorityKeyIdentifier," ")):"")+"\nvalidity: "+this.validityPeriod.notBefore.toISOString()+" \u2013 "+this.validityPeriod.notAfter.toISOString()+" (".concat(this.isValidAtMoment()?"currently valid":"not valid",")")+(this.keyUsage?"\nkey usage (".concat(this.keyUsage.critical?"critical":"non-critical","): ")+d(this.keyUsage.usages).join(", "):"")+(this.extKeyUsage?"\nextended key usage: TLS server \u2014\xa0".concat(this.extKeyUsage.serverTls,", TLS client \u2014\xa0").concat(this.extKeyUsage.clientTls):"")+(this.basicConstraints?"\nbasic constraints (".concat(this.basicConstraints.critical?"critical":"non-critical","): CA \u2014\xa0").concat(this.basicConstraints.ca,", path length \u2014 ").concat(this.basicConstraints.pathLength):"")+"\nsignature algorithm: "+ut(function(e){var t={"1.2.840.113549.1.1.1":{name:"RSAES-PKCS1-v1_5"},"1.2.840.113549.1.1.5":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}},"1.2.840.113549.1.1.11":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},"1.2.840.113549.1.1.12":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}},"1.2.840.113549.1.1.13":{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},"1.2.840.113549.1.1.10":{name:"RSA-PSS"},"1.2.840.113549.1.1.7":{name:"RSA-OAEP"},"1.2.840.10045.2.1":{name:"ECDSA",hash:{name:"SHA-1"}},"1.2.840.10045.4.1":{name:"ECDSA",hash:{name:"SHA-1"}},"1.2.840.10045.4.3.2":{name:"ECDSA",hash:{name:"SHA-256"}},"1.2.840.10045.4.3.3":{name:"ECDSA",hash:{name:"SHA-384"}},"1.2.840.10045.4.3.4":{name:"ECDSA",hash:{name:"SHA-512"}},"1.3.133.16.840.63.0.2":{name:"ECDH",kdf:"SHA-1"},"1.3.132.1.11.1":{name:"ECDH",kdf:"SHA-256"},"1.3.132.1.11.2":{name:"ECDH",kdf:"SHA-384"},"1.3.132.1.11.3":{name:"ECDH",kdf:"SHA-512"},"2.16.840.1.101.3.4.1.2":{name:"AES-CBC",length:128},"2.16.840.1.101.3.4.1.22":{name:"AES-CBC",length:192},"2.16.840.1.101.3.4.1.42":{name:"AES-CBC",length:256},"2.16.840.1.101.3.4.1.6":{name:"AES-GCM",length:128},"2.16.840.1.101.3.4.1.26":{name:"AES-GCM",length:192},"2.16.840.1.101.3.4.1.46":{name:"AES-GCM",length:256},"2.16.840.1.101.3.4.1.4":{name:"AES-CFB",length:128},"2.16.840.1.101.3.4.1.24":{name:"AES-CFB",length:192},"2.16.840.1.101.3.4.1.44":{name:"AES-CFB",length:256},"2.16.840.1.101.3.4.1.5":{name:"AES-KW",length:128},"2.16.840.1.101.3.4.1.25":{name:"AES-KW",length:192},"2.16.840.1.101.3.4.1.45":{name:"AES-KW",length:256},"1.2.840.113549.2.7":{name:"HMAC",hash:{name:"SHA-1"}},"1.2.840.113549.2.9":{name:"HMAC",hash:{name:"SHA-256"}},"1.2.840.113549.2.10":{name:"HMAC",hash:{name:"SHA-384"}},"1.2.840.113549.2.11":{name:"HMAC",hash:{name:"SHA-512"}},"1.2.840.113549.1.9.16.3.5":{name:"DH"},"1.3.14.3.2.26":{name:"SHA-1"},"2.16.840.1.101.3.4.2.1":{name:"SHA-256"},"2.16.840.1.101.3.4.2.2":{name:"SHA-384"},"2.16.840.1.101.3.4.2.3":{name:"SHA-512"},"1.2.840.113549.1.5.12":{name:"PBKDF2"},"1.2.840.10045.3.1.7":{name:"P-256"},"1.3.132.0.34":{name:"P-384"},"1.3.132.0.35":{name:"P-521"}}[e];if(void 0===t)throw new Error("Unsupported algorithm identifier: ".concat(e));return t}(this.algorithm))}},{key:"toJSON",value:function(){var e,t,n;return{serialNumber:d(this.serialNumber),algorithm:this.algorithm,issuer:this.issuer,validityPeriod:{notBefore:this.validityPeriod.notBefore.toISOString(),notAfter:this.validityPeriod.notAfter.toISOString()},subject:this.subject,publicKey:{identifiers:this.publicKey.identifiers,data:d(this.publicKey.data),all:d(this.publicKey.all)},signature:d(this.signature),keyUsage:{critical:null===(e=this.keyUsage)||void 0===e?void 0:e.critical,usages:d(null!==(t=null===(n=this.keyUsage)||void 0===n?void 0:n.usages)&&void 0!==t?t:[])},subjectAltNames:this.subjectAltNames,extKeyUsage:this.extKeyUsage,authorityKeyIdentifier:this.authorityKeyIdentifier&&d(this.authorityKeyIdentifier),subjectKeyIdentifier:this.subjectKeyIdentifier&&d(this.subjectKeyIdentifier),basicConstraints:this.basicConstraints,signedData:d(this.signedData)}}}],[{key:"fromPEM",value:function(e){for(var t="[A-Z0-9 ]+",n=new RegExp("-{5}BEGIN ".concat(t,"-{5}([a-zA-Z0-9=+\\/\\n\\r]+)-{5}END ").concat(t,"-{5}"),"g"),r=[],i=null;i=n.exec(e);){var s=new this(st(i[1].replace(/[\r\n]/g,"")));r.push(s)}return r}}]),e}(),Dt=function(e){w(n,e);var t=m(n);function n(){return y(this,n),t.apply(this,arguments)}return v(n)}(Nt),jt=new TextEncoder,Qt=function(){function e(t){var n=this;y(this,e),R(this,"queue"),R(this,"outstandingRequest"),this.ws=t,this.queue=[],t.addEventListener("message",(function(e){return n.enqueue(new Uint8Array(e.data))})),t.addEventListener("close",(function(){return n.dequeue()}))}return v(e,[{key:"enqueue",value:function(e){this.queue.push(e),this.dequeue()}},{key:"dequeue",value:function(){if(void 0!==this.outstandingRequest){var e=this.outstandingRequest,t=e.resolve,n=e.bytes,r=this.bytesInQueue();if(!(r<n&&this.ws.readyState<=1)){if(0===(n=Math.min(n,r)))return t(void 0);this.outstandingRequest=void 0;var i=this.queue[0],s=i.length;if(s===n)return this.queue.shift(),t(i);if(s>n)return this.queue[0]=i.subarray(n),t(i.subarray(0,n));for(var o=new Uint8Array(n),a=n,u=0;a>0;){var c=this.queue[0],f=c.length;f<=a?(this.queue.shift(),o.set(c,u),u+=f,a-=f):(this.queue[0]=c.subarray(a),o.set(c.subarray(0,a),u),u+=a-=a)}return t(o)}}}},{key:"bytesInQueue",value:function(){return this.queue.reduce((function(e,t){return e+t.length}),0)}},{key:"read",value:function(){var e=l(h().mark((function e(t){var n=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.outstandingRequest){e.next=2;break}throw new Error("Can\u2019t read while already awaiting read");case 2:return e.abrupt("return",new Promise((function(e){n.outstandingRequest={resolve:e,bytes:t},n.dequeue()})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()})),qt=U((function(){Ft="-----BEGIN CERTIFICATE-----\nMIIFazCCA1OgAwIBAgIRAIIQz7DSQONZRGPgu2OCiwAwDQYJKoZIhvcNAQELBQAw\nTzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5IFJlc2Vh\ncmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMTUwNjA0MTEwNDM4\nWhcNMzUwNjA0MTEwNDM4WjBPMQswCQYDVQQGEwJVUzEpMCcGA1UEChMgSW50ZXJu\nZXQgU2VjdXJpdHkgUmVzZWFyY2ggR3JvdXAxFTATBgNVBAMTDElTUkcgUm9vdCBY\nMTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAK3oJHP0FDfzm54rVygc\nh77ct984kIxuPOZXoHj3dcKi/vVqbvYATyjb3miGbESTtrFj/RQSa78f0uoxmyF+\n0TM8ukj13Xnfs7j/EvEhmkvBioZxaUpmZmyPfjxwv60pIgbz5MDmgK7iS4+3mX6U\nA5/TR5d8mUgjU+g4rk8Kb4Mu0UlXjIB0ttov0DiNewNwIRt18jA8+o+u3dpjq+sW\nT8KOEUt+zwvo/7V3LvSye0rgTBIlDHCNAymg4VMk7BPZ7hm/ELNKjD+Jo2FR3qyH\nB5T0Y3HsLuJvW5iB4YlcNHlsdu87kGJ55tukmi8mxdAQ4Q7e2RCOFvu396j3x+UC\nB5iPNgiV5+I3lg02dZ77DnKxHZu8A/lJBdiB3QW0KtZB6awBdpUKD9jf1b0SHzUv\nKBds0pjBqAlkd25HN7rOrFleaJ1/ctaJxQZBKT5ZPt0m9STJEadao0xAH0ahmbWn\nOlFuhjuefXKnEgV4We0+UXgVCwOPjdAvBbI+e0ocS3MFEvzG6uBQE3xDk3SzynTn\njh8BCNAw1FtxNrQHusEwMFxIt4I7mKZ9YIqioymCzLq9gwQbooMDQaHWBfEbwrbw\nqHyGO0aoSCqI3Haadr8faqU9GY/rOPNk3sgrDQoo//fb4hVC1CLQJ13hef4Y53CI\nrU7m2Ys6xt0nUW7/vGT1M0NPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNV\nHRMBAf8EBTADAQH/MB0GA1UdDgQWBBR5tFnme7bl5AFzgAiIyBpY9umbbjANBgkq\nhkiG9w0BAQsFAAOCAgEAVR9YqbyyqFDQDLHYGmkgJykIrGF1XIpu+ILlaS/V9lZL\nubhzEFnTIZd+50xx+7LSYK05qAvqFyFWhfFQDlnrzuBZ6brJFe+GnY+EgPbk6ZGQ\n3BebYhtF8GaV0nxvwuo77x/Py9auJ/GpsMiu/X1+mvoiBOv/2X/qkSsisRcOj/KK\nNFtY2PwByVS5uCbMiogziUwthDyC3+6WVwW6LLv3xLfHTjuCvjHIInNzktHCgKQ5\nORAzI4JMPJ+GslWYHb4phowim57iaztXOoJwTdwJx4nLCgdNbOhdjsnvzqvHu7Ur\nTkXWStAmzOVyyghqpZXjFaH3pO3JLF+l+/+sKAIuvtd7u+Nxe5AW0wdeRlN8NwdC\njNPElpzVmbUq4JUagEiuTDkHzsxHpFKVK7q4+63SM1N95R1NbdWhscdCb+ZAJzVc\noyi3B43njTOQ5yOf+1CceWxG1bQVs5ZufpsMljq4Ui0/1lvh+wjChP4kqKOJ2qxq\n4RgqsahDYVvTH9w7jXbyLeiNdd8XM2w9U/t7y0Ff/9yi0GE44Za4rF2LN9d11TPA\nmRGunUHBcnWEvgJBQl9nJEiU0Zsnvgc/ubhPgXRR4Xq37Z0j4r7g1SgEEzwxA57d\nemyPxgcYxn/eR44/KJ4EBs+lVDR3veyJm+kXQ99b21/+jh5Xos1AnX5iItreGCc=\n-----END CERTIFICATE-----\n"})),Kt={};function Vt(e){return 0}L(Kt,{Socket:function(){return Zt},isIP:function(){return Vt}});var Gt,Wt,Zt,zt=U((function(){N(),Gt=M(D(),1),Ht(),qt(),Wt=function(e){w(n,e);var t=m(n);function n(){var e;return y(this,n),e=t.apply(this,arguments),R(g(e),"_webSocketConstructor"),R(g(e),"_wsProxy"),R(g(e),"_coalesceWrites"),R(g(e),"_useSecureWebSocket"),R(g(e),"_disableSNI"),R(g(e),"_pipelineConnect"),R(g(e),"_pipelineTLS"),R(g(e),"_rootCerts"),R(g(e),"connecting",!1),R(g(e),"pending",!0),R(g(e),"writable",!0),R(g(e),"encrypted",!1),R(g(e),"authorized",!1),R(g(e),"destroyed",!1),R(g(e),"ws",null),R(g(e),"writeBuffer"),R(g(e),"tlsState",0),R(g(e),"tlsRead"),R(g(e),"tlsWrite"),e}return v(n,[{key:"webSocketConstructor",get:function(){var e,t;return null!==(e=null!==(t=this._webSocketConstructor)&&void 0!==t?t:Wt.webSocketConstructor)&&void 0!==e?e:Wt.defaults.webSocketConstructor},set:function(e){this._webSocketConstructor=e}},{key:"wsProxy",get:function(){var e,t;return null!==(e=null!==(t=this._wsProxy)&&void 0!==t?t:Wt.wsProxy)&&void 0!==e?e:Wt.defaults.wsProxy},set:function(e){this._wsProxy=e}},{key:"coalesceWrites",get:function(){var e,t;return null!==(e=null!==(t=this._coalesceWrites)&&void 0!==t?t:Wt.coalesceWrites)&&void 0!==e?e:Wt.defaults.coalesceWrites},set:function(e){this._coalesceWrites=e}},{key:"useSecureWebSocket",get:function(){var e,t;return null!==(e=null!==(t=this._useSecureWebSocket)&&void 0!==t?t:Wt.useSecureWebSocket)&&void 0!==e?e:Wt.defaults.useSecureWebSocket},set:function(e){this._useSecureWebSocket=e}},{key:"disableSNI",get:function(){var e,t;return null!==(e=null!==(t=this._disableSNI)&&void 0!==t?t:Wt.disableSNI)&&void 0!==e?e:Wt.defaults.disableSNI},set:function(e){this._disableSNI=e}},{key:"pipelineConnect",get:function(){var e,t;return null!==(e=null!==(t=this._pipelineConnect)&&void 0!==t?t:Wt.pipelineConnect)&&void 0!==e?e:Wt.defaults.pipelineConnect},set:function(e){this._pipelineConnect=e}},{key:"pipelineTLS",get:function(){var e,t;return null!==(e=null!==(t=this._pipelineTLS)&&void 0!==t?t:Wt.pipelineTLS)&&void 0!==e?e:Wt.defaults.pipelineTLS},set:function(e){this._pipelineTLS=e}},{key:"rootCerts",get:function(){var e,t;return null!==(e=null!==(t=this._rootCerts)&&void 0!==t?t:Wt.rootCerts)&&void 0!==e?e:Wt.defaults.rootCerts},set:function(e){this._rootCerts=e}},{key:"wsProxyAddrForHost",value:function(e,t){var n=this.wsProxy;if(void 0===n)throw new Error("No WebSocket proxy is configured. Please refer to https://github.com/neondatabase/serverless#run-your-own-websocket-proxy");return"function"==typeof n?n(e,t):"".concat(n,"?address=").concat(e,":").concat(t)}},{key:"setNoDelay",value:function(){return this}},{key:"setKeepAlive",value:function(){return this}},{key:"ref",value:function(){return this}},{key:"unref",value:function(){return this}},{key:"connect",value:function(){var e=l(h().mark((function e(t,n,r){var i,s=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.connecting=!0,r&&this.once("connect",r),e.prev=1,i=this.wsProxyAddrForHost(n,"string"==typeof t?parseInt(t,10):t),e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(1),this.emit("error",e.t0),this.emit("close"),e.abrupt("return");case 9:return e.next=11,new Promise(function(){var e=l(h().mark((function e(t){var n,r,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=(s.useSecureWebSocket?"wss:":"ws:")+"//"+i,void 0!==s.webSocketConstructor)r=new s.webSocketConstructor(n);else try{r=new WebSocket(n)}catch(a){r=new __unstable_WebSocket(n)}r.addEventListener("open",(function(){t(r)})),e.next=18;break;case 6:return e.prev=6,e.t0=e.catch(0),e.prev=8,o=(s.useSecureWebSocket?"https:":"http:")+"//"+i,e.next=12,fetch(o,{headers:{Upgrade:"websocket"}}).then((function(n){var r=n.webSocket;if(null==r)throw e.t0;r.accept(),t(r)}));case 12:e.next=18;break;case 14:return e.prev=14,e.t1=e.catch(8),s.emit("error",new Error("All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless#run-on-node")),s.emit("close"),e.abrupt("return");case 18:case"end":return e.stop()}}),e,null,[[0,6],[8,14]])})));return function(t){return e.apply(this,arguments)}}());case 11:return this.ws=e.sent,this.ws.binaryType="arraybuffer",this.ws.addEventListener("error",(function(e){s.emit("error",e),s.emit("close")})),this.ws.addEventListener("close",(function(){s.emit("close")})),this.ws.addEventListener("message",(function(e){if(0===s.tlsState){var t=o.from(e.data);s.emit("data",t)}})),this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready"),e.abrupt("return",this);case 21:case"end":return e.stop()}}),e,this,[[1,5]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"startTls",value:function(){var e=l(h().mark((function e(t){var n,r,i,s,o,a,u,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tlsState=1,n=Dt.fromPEM(Ft),r=new Qt(this.ws),i=r.read.bind(r),s=this.rawWrite.bind(this),e.next=7,yt(t,n,i,s,!this.disableSNI,void 0,this.pipelineTLS?new Uint8Array([83]):void 0);case 7:o=e.sent,a=p(o,2),u=a[0],c=a[1],this.tlsRead=u,this.tlsWrite=c,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop();case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"tlsReadLoop",value:function(){var e=l(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tlsRead();case 2:if(void 0!==(t=e.sent)){e.next=5;break}return e.abrupt("break",9);case 5:n=o.from(t),this.emit("data",n);case 7:e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"rawWrite",value:function(e){var t=this;if(this.coalesceWrites)if(void 0===this.writeBuffer)this.writeBuffer=e,setTimeout((function(){t.ws.send(t.writeBuffer),t.writeBuffer=void 0}),0);else{var n=new Uint8Array(this.writeBuffer.length+e.length);n.set(this.writeBuffer),n.set(e,this.writeBuffer.length),this.writeBuffer=n}else this.ws.send(e)}},{key:"write",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){};return 0===e.length?r():("string"==typeof e&&(e=o.from(e,n)),0===this.tlsState?this.rawWrite(e):1===this.tlsState?this.once("secureConnection",(function(){return t.write(e,n,r)})):this.tlsWrite(e),!0)}},{key:"end",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.alloc(0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=arguments.length>2?arguments[2]:void 0;return this.write(t,n,(function(){e.ws.close(),r&&r()})),this}},{key:"destroy",value:function(){return this.destroyed=!0,this.end()}}]),n}(Gt.EventEmitter),R(Zt=Wt,"defaults",{webSocketConstructor:void 0,wsProxy:function(e){return e+"/v2"},useSecureWebSocket:!0,coalesceWrites:!0,disableSNI:!1,pipelineConnect:"password",pipelineTLS:!0,rootCerts:Ft}),R(Zt,"webSocketConstructor"),R(Zt,"wsProxy"),R(Zt,"coalesceWrites"),R(Zt,"useSecureWebSocket"),R(Zt,"disableSNI"),R(Zt,"pipelineConnect"),R(Zt,"pipelineTLS"),R(Zt,"rootCerts")})),Yt=C((function(e){N(),Object.defineProperty(e,"__esModule",{value:!0}),e.NoticeMessage=e.DataRowMessage=e.CommandCompleteMessage=e.ReadyForQueryMessage=e.NotificationResponseMessage=e.BackendKeyDataMessage=e.AuthenticationMD5Password=e.ParameterStatusMessage=e.ParameterDescriptionMessage=e.RowDescriptionMessage=e.Field=e.CopyResponse=e.CopyDataMessage=e.DatabaseError=e.copyDone=e.emptyQuery=e.replicationStart=e.portalSuspended=e.noData=e.closeComplete=e.bindComplete=e.parseComplete=void 0,e.parseComplete={name:"parseComplete",length:5},e.bindComplete={name:"bindComplete",length:5},e.closeComplete={name:"closeComplete",length:5},e.noData={name:"noData",length:5},e.portalSuspended={name:"portalSuspended",length:5},e.replicationStart={name:"replicationStart",length:4},e.emptyQuery={name:"emptyQuery",length:4},e.copyDone={name:"copyDone",length:4};var t=function(e){w(n,e);var t=m(n);function n(e,r,i){var s;return y(this,n),(s=t.call(this,e)).length=r,s.name=i,s}return v(n)}(f(Error));e.DatabaseError=t;var n=v((function e(t,n){y(this,e),this.length=t,this.chunk=n,this.name="copyData"}));e.CopyDataMessage=n;var r=v((function e(t,n,r,i){y(this,e),this.length=t,this.name=n,this.binary=r,this.columnTypes=new Array(i)}));e.CopyResponse=r;var i=v((function e(t,n,r,i,s,o,a){y(this,e),this.name=t,this.tableID=n,this.columnID=r,this.dataTypeID=i,this.dataTypeSize=s,this.dataTypeModifier=o,this.format=a}));e.Field=i;var s=v((function e(t,n){y(this,e),this.length=t,this.fieldCount=n,this.name="rowDescription",this.fields=new Array(this.fieldCount)}));e.RowDescriptionMessage=s;var o=v((function e(t,n){y(this,e),this.length=t,this.parameterCount=n,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}));e.ParameterDescriptionMessage=o;var a=v((function e(t,n,r){y(this,e),this.length=t,this.parameterName=n,this.parameterValue=r,this.name="parameterStatus"}));e.ParameterStatusMessage=a;var u=v((function e(t,n){y(this,e),this.length=t,this.salt=n,this.name="authenticationMD5Password"}));e.AuthenticationMD5Password=u;var c=v((function e(t,n,r){y(this,e),this.length=t,this.processID=n,this.secretKey=r,this.name="backendKeyData"}));e.BackendKeyDataMessage=c;var h=v((function e(t,n,r,i){y(this,e),this.length=t,this.processId=n,this.channel=r,this.payload=i,this.name="notification"}));e.NotificationResponseMessage=h;var l=v((function e(t,n){y(this,e),this.length=t,this.status=n,this.name="readyForQuery"}));e.ReadyForQueryMessage=l;var p=v((function e(t,n){y(this,e),this.length=t,this.text=n,this.name="commandComplete"}));e.CommandCompleteMessage=p;var d=v((function e(t,n){y(this,e),this.length=t,this.fields=n,this.name="dataRow",this.fieldCount=n.length}));e.DataRowMessage=d;var g=v((function e(t,n){y(this,e),this.length=t,this.message=n,this.name="notice"}));e.NoticeMessage=g})),Jt=C((function(e){N(),Object.defineProperty(e,"__esModule",{value:!0}),e.Writer=void 0;var t=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;y(this,e),this.size=t,this.offset=5,this.headerPosition=0,this.buffer=o.allocUnsafe(t)}return v(e,[{key:"ensure",value:function(e){if(this.buffer.length-this.offset<e){var t=this.buffer,n=t.length+(t.length>>1)+e;this.buffer=o.allocUnsafe(n),t.copy(this.buffer)}}},{key:"addInt32",value:function(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}},{key:"addInt16",value:function(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}},{key:"addCString",value:function(e){if(e){var t=o.byteLength(e);this.ensure(t+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=t}else this.ensure(1);return this.buffer[this.offset++]=0,this}},{key:"addString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=o.byteLength(e);return this.ensure(t),this.buffer.write(e,this.offset),this.offset+=t,this}},{key:"add",value:function(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}},{key:"join",value:function(e){if(e){this.buffer[this.headerPosition]=e;var t=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(t,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}},{key:"flush",value:function(e){var t=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=o.allocUnsafe(this.size),t}}]),e}();e.Writer=t})),Xt=C((function(e){N(),Object.defineProperty(e,"__esModule",{value:!0}),e.serialize=void 0;var t=Jt(),n=new t.Writer,r=[],i=new t.Writer,s=o.from([69,0,0,0,9,0,0,0,0,0]),a=function(e,t){var n=4+o.byteLength(t)+1,r=o.allocUnsafe(1+n);return r[0]=e,r.writeInt32BE(n,1),r.write(t,5,"utf-8"),r[n]=0,r},u=n.addCString("P").flush(68),c=n.addCString("S").flush(68),f=function(e){return o.from([e,0,0,0,4])},h=f(72),l=f(83),p=f(88),d=f(99),y={startup:function(e){n.addInt16(3).addInt16(0);for(var r=0,i=Object.keys(e);r<i.length;r++){var s=i[r];n.addCString(s).addCString(e[s])}n.addCString("client_encoding").addCString("UTF8");var o=n.addCString("").flush(),a=o.length+4;return(new t.Writer).addInt32(a).add(o).flush()},password:function(e){return n.addCString(e).flush(112)},requestSsl:function(){var e=o.allocUnsafe(8);return e.writeInt32BE(8,0),e.writeInt32BE(80877103,4),e},sendSASLInitialResponseMessage:function(e,t){return n.addCString(e).addInt32(o.byteLength(t)).addString(t),n.flush(112)},sendSCRAMClientFinalMessage:function(e){return n.addString(e).flush(112)},query:function(e){return n.addCString(e).flush(81)},parse:function(e){var t=e.name||"";t.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",t,t.length),console.error("This can cause conflicts and silent errors executing queries"));for(var i=e.types||r,s=i.length,o=n.addCString(t).addCString(e.text).addInt16(s),a=0;a<s;a++)o.addInt32(i[a]);return n.flush(80)},bind:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.portal||"",s=e.statement||"",a=e.binary||!1,u=e.values||r,c=u.length;return n.addCString(t).addCString(s),n.addInt16(c),function(e,t){for(var r=0;r<e.length;r++){var s=t?t(e[r],r):e[r];null==s?(n.addInt16(0),i.addInt32(-1)):s instanceof o?(n.addInt16(1),i.addInt32(s.length),i.add(s)):(n.addInt16(0),i.addInt32(o.byteLength(s)),i.addString(s))}}(u,e.valueMapper),n.addInt16(c),n.add(i.flush()),n.addInt16(a?1:0),n.flush(66)},execute:function(e){if(!e||!e.portal&&!e.rows)return s;var t=e.portal||"",n=e.rows||0,r=o.byteLength(t),i=4+r+1+4,a=o.allocUnsafe(1+i);return a[0]=69,a.writeInt32BE(i,1),a.write(t,5,"utf-8"),a[r+5]=0,a.writeUInt32BE(n,a.length-4),a},describe:function(e){return e.name?a(68,"".concat(e.type).concat(e.name||"")):"P"===e.type?u:c},close:function(e){var t="".concat(e.type).concat(e.name||"");return a(67,t)},flush:function(){return h},sync:function(){return l},end:function(){return p},copyData:function(e){return n.add(e).flush(100)},copyDone:function(){return d},copyFail:function(e){return a(102,e)},cancel:function(e,t){var n=o.allocUnsafe(16);return n.writeInt32BE(16,0),n.writeInt16BE(1234,4),n.writeInt16BE(5678,6),n.writeInt32BE(e,8),n.writeInt32BE(t,12),n}};e.serialize=y})),$t=C((function(e){N(),Object.defineProperty(e,"__esModule",{value:!0}),e.BufferReader=void 0;var t=o.allocUnsafe(0),n=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;y(this,e),this.offset=n,this.buffer=t,this.encoding="utf-8"}return v(e,[{key:"setBuffer",value:function(e,t){this.offset=e,this.buffer=t}},{key:"int16",value:function(){var e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}},{key:"byte",value:function(){var e=this.buffer[this.offset];return this.offset++,e}},{key:"int32",value:function(){var e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}},{key:"string",value:function(e){var t=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,t}},{key:"cstring",value:function(){for(var e=this.offset,t=e;0!==this.buffer[t++];);return this.offset=t,this.buffer.toString(this.encoding,e,t-1)}},{key:"bytes",value:function(e){var t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}}]),e}();e.BufferReader=n})),en={};L(en,{default:function(){return tn}});var tn,nn=U((function(){N(),tn={}})),rn=C((function(e){N();var t=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=void 0;var n=Yt(),r=$t(),i=t((nn(),T(en))),s=o.allocUnsafe(0),a=function(){function e(t){if(y(this,e),this.buffer=s,this.bufferLength=0,this.bufferOffset=0,this.reader=new r.BufferReader,"binary"===(null===t||void 0===t?void 0:t.mode))throw new Error("Binary mode not supported yet");this.mode=(null===t||void 0===t?void 0:t.mode)||"text"}return v(e,[{key:"parse",value:function(e,t){this.mergeBuffer(e);for(var n=this.bufferOffset+this.bufferLength,r=this.bufferOffset;r+5<=n;){var i=this.buffer[r],o=this.buffer.readUInt32BE(r+1),a=1+o;if(!(a+r<=n))break;t(this.handlePacket(r+5,i,o,this.buffer)),r+=a}r===n?(this.buffer=s,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=n-r,this.bufferOffset=r)}},{key:"mergeBuffer",value:function(e){if(this.bufferLength>0){var t=this.bufferLength+e.byteLength;if(t+this.bufferOffset>this.buffer.byteLength){var n;if(t<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)n=this.buffer;else{for(var r=2*this.buffer.byteLength;t>=r;)r*=2;n=o.allocUnsafe(r)}this.buffer.copy(n,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=n,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=t}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}},{key:"handlePacket",value:function(e,t,r,s){switch(t){case 50:return n.bindComplete;case 49:return n.parseComplete;case 51:return n.closeComplete;case 110:return n.noData;case 115:return n.portalSuspended;case 99:return n.copyDone;case 87:return n.replicationStart;case 73:return n.emptyQuery;case 68:return this.parseDataRowMessage(e,r,s);case 67:return this.parseCommandCompleteMessage(e,r,s);case 90:return this.parseReadyForQueryMessage(e,r,s);case 65:return this.parseNotificationMessage(e,r,s);case 82:return this.parseAuthenticationResponse(e,r,s);case 83:return this.parseParameterStatusMessage(e,r,s);case 75:return this.parseBackendKeyData(e,r,s);case 69:return this.parseErrorMessage(e,r,s,"error");case 78:return this.parseErrorMessage(e,r,s,"notice");case 84:return this.parseRowDescriptionMessage(e,r,s);case 116:return this.parseParameterDescriptionMessage(e,r,s);case 71:return this.parseCopyInMessage(e,r,s);case 72:return this.parseCopyOutMessage(e,r,s);case 100:return this.parseCopyData(e,r,s);default:i.default.fail("unknown message code: ".concat(t.toString(16)))}}},{key:"parseReadyForQueryMessage",value:function(e,t,r){this.reader.setBuffer(e,r);var i=this.reader.string(1);return new n.ReadyForQueryMessage(t,i)}},{key:"parseCommandCompleteMessage",value:function(e,t,r){this.reader.setBuffer(e,r);var i=this.reader.cstring();return new n.CommandCompleteMessage(t,i)}},{key:"parseCopyData",value:function(e,t,r){var i=r.slice(e,e+(t-4));return new n.CopyDataMessage(t,i)}},{key:"parseCopyInMessage",value:function(e,t,n){return this.parseCopyMessage(e,t,n,"copyInResponse")}},{key:"parseCopyOutMessage",value:function(e,t,n){return this.parseCopyMessage(e,t,n,"copyOutResponse")}},{key:"parseCopyMessage",value:function(e,t,r,i){this.reader.setBuffer(e,r);for(var s=0!==this.reader.byte(),o=this.reader.int16(),a=new n.CopyResponse(t,i,s,o),u=0;u<o;u++)a.columnTypes[u]=this.reader.int16();return a}},{key:"parseNotificationMessage",value:function(e,t,r){this.reader.setBuffer(e,r);var i=this.reader.int32(),s=this.reader.cstring(),o=this.reader.cstring();return new n.NotificationResponseMessage(t,i,s,o)}},{key:"parseRowDescriptionMessage",value:function(e,t,r){this.reader.setBuffer(e,r);for(var i=this.reader.int16(),s=new n.RowDescriptionMessage(t,i),o=0;o<i;o++)s.fields[o]=this.parseField();return s}},{key:"parseField",value:function(){var e=this.reader.cstring(),t=this.reader.int32(),r=this.reader.int16(),i=this.reader.int32(),s=this.reader.int16(),o=this.reader.int32(),a=0===this.reader.int16()?"text":"binary";return new n.Field(e,t,r,i,s,o,a)}},{key:"parseParameterDescriptionMessage",value:function(e,t,r){this.reader.setBuffer(e,r);for(var i=this.reader.int16(),s=new n.ParameterDescriptionMessage(t,i),o=0;o<i;o++)s.dataTypeIDs[o]=this.reader.int32();return s}},{key:"parseDataRowMessage",value:function(e,t,r){this.reader.setBuffer(e,r);for(var i=this.reader.int16(),s=new Array(i),o=0;o<i;o++){var a=this.reader.int32();s[o]=-1===a?null:this.reader.string(a)}return new n.DataRowMessage(t,s)}},{key:"parseParameterStatusMessage",value:function(e,t,r){this.reader.setBuffer(e,r);var i=this.reader.cstring(),s=this.reader.cstring();return new n.ParameterStatusMessage(t,i,s)}},{key:"parseBackendKeyData",value:function(e,t,r){this.reader.setBuffer(e,r);var i=this.reader.int32(),s=this.reader.int32();return new n.BackendKeyDataMessage(t,i,s)}},{key:"parseAuthenticationResponse",value:function(e,t,r){this.reader.setBuffer(e,r);var i=this.reader.int32(),s={name:"authenticationOk",length:t};switch(i){case 0:break;case 3:8===s.length&&(s.name="authenticationCleartextPassword");break;case 5:if(12===s.length){s.name="authenticationMD5Password";var o=this.reader.bytes(4);return new n.AuthenticationMD5Password(t,o)}break;case 10:var a;s.name="authenticationSASL",s.mechanisms=[];do{(a=this.reader.cstring())&&s.mechanisms.push(a)}while(a);break;case 11:s.name="authenticationSASLContinue",s.data=this.reader.string(t-8);break;case 12:s.name="authenticationSASLFinal",s.data=this.reader.string(t-8);break;default:throw new Error("Unknown authenticationOk message type "+i)}return s}},{key:"parseErrorMessage",value:function(e,t,r,i){this.reader.setBuffer(e,r);for(var s={},o=this.reader.string(1);"\0"!==o;)s[o]=this.reader.cstring(),o=this.reader.string(1);var a=s.M,u="notice"===i?new n.NoticeMessage(t,a):new n.DatabaseError(a,t,i);return u.severity=s.S,u.code=s.C,u.detail=s.D,u.hint=s.H,u.position=s.P,u.internalPosition=s.p,u.internalQuery=s.q,u.where=s.W,u.schema=s.s,u.table=s.t,u.column=s.c,u.dataType=s.d,u.constraint=s.n,u.file=s.F,u.line=s.L,u.routine=s.R,u}}]),e}();e.Parser=a})),sn=C((function(e){N(),Object.defineProperty(e,"__esModule",{value:!0}),e.DatabaseError=e.serialize=e.parse=void 0;var t=Yt();Object.defineProperty(e,"DatabaseError",{enumerable:!0,get:function(){return t.DatabaseError}});var n=Xt();Object.defineProperty(e,"serialize",{enumerable:!0,get:function(){return n.serialize}});var r=rn();e.parse=function(e,t){var n=new r.Parser;return e.on("data",(function(e){return n.parse(e,t)})),new Promise((function(t){return e.on("end",(function(){return t()}))}))}})),on={};function an(e){var t=e.socket,n=e.servername;return t.startTls(n),t}L(on,{connect:function(){return an}});var un=U((function(){N()})),cn=C((function(e,t){N();var n=(zt(),T(Kt)),r=D().EventEmitter,i=sn(),s=i.parse,o=i.serialize,a=o.flush(),u=o.sync(),c=o.end(),f=function(e){w(r,e);var t=m(r);function r(e){var i;y(this,r),e=e||{},(i=t.call(this)).stream=e.stream||new n.Socket,"function"==typeof i.stream&&(i.stream=i.stream(e)),i._keepAlive=e.keepAlive,i._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,i.lastBuffer=!1,i.parsedStatements={},i.ssl=e.ssl||!1,i._ending=!1,i._emitMessage=!1;var s=g(i);return i.on("newListener",(function(e){"message"===e&&(s._emitMessage=!0)})),i}return v(r,[{key:"connect",value:function(e,t){var r=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,t),this.stream.once("connect",(function(){r._keepAlive&&r.stream.setKeepAlive(!0,r._keepAliveInitialDelayMillis),r.emit("connect")}));var i=function(e){r._ending&&("ECONNRESET"===e.code||"EPIPE"===e.code)||r.emit("error",e)};if(this.stream.on("error",i),this.stream.on("close",(function(){r.emit("end")})),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",(function(e){switch(e.toString("utf8")){case"S":break;case"N":return r.stream.end(),r.emit("error",new Error("The server does not support SSL connections"));default:return r.stream.end(),r.emit("error",new Error("There was an error establishing an SSL connection"))}var s=(un(),T(on)),o={socket:r.stream};!0!==r.ssl&&(Object.assign(o,r.ssl),"key"in r.ssl&&(o.key=r.ssl.key)),0===n.isIP(t)&&(o.servername=t);try{r.stream=s.connect(o)}catch(a){return r.emit("error",a)}r.attachListeners(r.stream),r.stream.on("error",i),r.emit("sslconnect")}))}},{key:"attachListeners",value:function(e){var t=this;e.on("end",(function(){t.emit("end")})),s(e,(function(e){var n="error"===e.name?"errorMessage":e.name;t._emitMessage&&t.emit("message",e),t.emit(n,e)}))}},{key:"requestSsl",value:function(){this.stream.write(o.requestSsl())}},{key:"startup",value:function(e){this.stream.write(o.startup(e))}},{key:"cancel",value:function(e,t){this._send(o.cancel(e,t))}},{key:"password",value:function(e){this._send(o.password(e))}},{key:"sendSASLInitialResponseMessage",value:function(e,t){this._send(o.sendSASLInitialResponseMessage(e,t))}},{key:"sendSCRAMClientFinalMessage",value:function(e){this._send(o.sendSCRAMClientFinalMessage(e))}},{key:"_send",value:function(e){return!!this.stream.writable&&this.stream.write(e)}},{key:"query",value:function(e){this._send(o.query(e))}},{key:"parse",value:function(e){this._send(o.parse(e))}},{key:"bind",value:function(e){this._send(o.bind(e))}},{key:"execute",value:function(e){this._send(o.execute(e))}},{key:"flush",value:function(){this.stream.writable&&this.stream.write(a)}},{key:"sync",value:function(){this._ending=!0,this._send(u)}},{key:"ref",value:function(){this.stream.ref()}},{key:"unref",value:function(){this.stream.unref()}},{key:"end",value:function(){var e=this;if(this._ending=!0,this._connecting&&this.stream.writable)return this.stream.write(c,(function(){e.stream.end()}));this.stream.end()}},{key:"close",value:function(e){this._send(o.close(e))}},{key:"describe",value:function(e){this._send(o.describe(e))}},{key:"sendCopyFromChunk",value:function(e){this._send(o.copyData(e))}},{key:"endCopyFrom",value:function(){this._send(o.copyDone())}},{key:"sendCopyFail",value:function(e){this._send(o.copyFail(e))}}]),r}(r);t.exports=f})),fn=C((function(e,t){N();var n=D().EventEmitter,i=ie(),s=se(),o=Ee(),u=Ae(),c=Te(),f=Pe(),h=re(),l=cn(),p=function(e){w(n,e);var t=m(n);function n(e){var i;y(this,n),(i=t.call(this)).connectionParameters=new c(e),i.user=i.connectionParameters.user,i.database=i.connectionParameters.database,i.port=i.connectionParameters.port,i.host=i.connectionParameters.host,Object.defineProperty(g(i),"password",{configurable:!0,enumerable:!1,writable:!0,value:i.connectionParameters.password}),i.replication=i.connectionParameters.replication;var s=e||{};return i._Promise=s.Promise||r.Promise,i._types=new u(s.types),i._ending=!1,i._connecting=!1,i._connected=!1,i._connectionError=!1,i._queryable=!0,i.connection=s.connection||new l({stream:s.stream,ssl:i.connectionParameters.ssl,keepAlive:s.keepAlive||!1,keepAliveInitialDelayMillis:s.keepAliveInitialDelayMillis||0,encoding:i.connectionParameters.client_encoding||"utf8"}),i.queryQueue=[],i.binary=s.binary||h.binary,i.processID=null,i.secretKey=null,i.ssl=i.connectionParameters.ssl||!1,i.ssl&&i.ssl.key&&Object.defineProperty(i.ssl,"key",{enumerable:!1}),i._connectionTimeoutMillis=s.connectionTimeoutMillis||0,i}return v(n,[{key:"_errorAllQueries",value:function(e){var t=this,n=function(n){a.nextTick((function(){n.handleError(e,t.connection)}))};this.activeQuery&&(n(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(n),this.queryQueue.length=0}},{key:"_connect",value:function(e){var t=this,n=this,r=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){var i=new Error("Client has already been connected. You cannot reuse a client.");a.nextTick((function(){e(i)}))}else this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout((function(){r._ending=!0,r.stream.destroy(new Error("timeout expired"))}),this._connectionTimeoutMillis)),this.host&&0===this.host.indexOf("/")?r.connect(this.host+"/.s.PGSQL."+this.port):r.connect(this.port,this.host),r.on("connect",(function(){n.ssl?r.requestSsl():r.startup(n.getStartupConf())})),r.on("sslconnect",(function(){r.startup(n.getStartupConf())})),this._attachListeners(r),r.once("end",(function(){var e=t._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(t.connectionTimeoutHandle),t._errorAllQueries(e),t._ending||(t._connecting&&!t._connectionError?t._connectionCallback?t._connectionCallback(e):t._handleErrorEvent(e):t._connectionError||t._handleErrorEvent(e)),a.nextTick((function(){t.emit("end")}))}))}},{key:"connect",value:function(e){var t=this;if(!e)return new this._Promise((function(e,n){t._connect((function(t){t?n(t):e()}))}));this._connect(e)}},{key:"_attachListeners",value:function(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}},{key:"_checkPgPass",value:function(e){var t=this,n=this.connection;"function"==typeof this.password?this._Promise.resolve().then((function(){return t.password()})).then((function(r){if(void 0!==r){if("string"!=typeof r)return void n.emit("error",new TypeError("Password must be a string"));t.connectionParameters.password=t.password=r}else t.connectionParameters.password=t.password=null;e()})).catch((function(e){n.emit("error",e)})):null!==this.password?e():o(this.connectionParameters,(function(n){void 0!==n&&(t.connectionParameters.password=t.password=n),e()}))}},{key:"_handleAuthCleartextPassword",value:function(e){var t=this;this._checkPgPass((function(){t.connection.password(t.password)}))}},{key:"_handleAuthMD5Password",value:function(e){var t=this;this._checkPgPass((function(){var n=i.postgresMd5PasswordHash(t.user,t.password,e.salt);t.connection.password(n)}))}},{key:"_handleAuthSASL",value:function(e){var t=this;this._checkPgPass((function(){try{t.saslSession=s.startSession(e.mechanisms),t.connection.sendSASLInitialResponseMessage(t.saslSession.mechanism,t.saslSession.response)}catch(n){t.connection.emit("error",n)}}))}},{key:"_handleAuthSASLContinue",value:function(e){try{s.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(t){this.connection.emit("error",t)}}},{key:"_handleAuthSASLFinal",value:function(e){try{s.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(t){this.connection.emit("error",t)}}},{key:"_handleBackendKeyData",value:function(e){this.processID=e.processID,this.secretKey=e.secretKey}},{key:"_handleReadyForQuery",value:function(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));var t=this.activeQuery;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}},{key:"_handleErrorWhileConnecting",value:function(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}},{key:"_handleErrorEvent",value:function(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}},{key:"_handleErrorMessage",value:function(e){if(this._connecting)return this._handleErrorWhileConnecting(e);var t=this.activeQuery;t?(this.activeQuery=null,t.handleError(e,this.connection)):this._handleErrorEvent(e)}},{key:"_handleRowDescription",value:function(e){this.activeQuery.handleRowDescription(e)}},{key:"_handleDataRow",value:function(e){this.activeQuery.handleDataRow(e)}},{key:"_handlePortalSuspended",value:function(e){this.activeQuery.handlePortalSuspended(this.connection)}},{key:"_handleEmptyQuery",value:function(e){this.activeQuery.handleEmptyQuery(this.connection)}},{key:"_handleCommandComplete",value:function(e){this.activeQuery.handleCommandComplete(e,this.connection)}},{key:"_handleParseComplete",value:function(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}},{key:"_handleCopyInResponse",value:function(e){this.activeQuery.handleCopyInResponse(this.connection)}},{key:"_handleCopyData",value:function(e){this.activeQuery.handleCopyData(e,this.connection)}},{key:"_handleNotification",value:function(e){this.emit("notification",e)}},{key:"_handleNotice",value:function(e){this.emit("notice",e)}},{key:"getStartupConf",value:function(){var e=this.connectionParameters,t={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(t.application_name=n),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}},{key:"cancel",value:function(e,t){if(e.activeQuery===t){var n=this.connection;this.host&&0===this.host.indexOf("/")?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",(function(){n.cancel(e.processID,e.secretKey)}))}else-1!==e.queryQueue.indexOf(t)&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}},{key:"setTypeParser",value:function(e,t,n){return this._types.setTypeParser(e,t,n)}},{key:"getTypeParser",value:function(e,t){return this._types.getTypeParser(e,t)}},{key:"escapeIdentifier",value:function(e){return'"'+e.replace(/"/g,'""')+'"'}},{key:"escapeLiteral",value:function(e){for(var t=!1,n="'",r=0;r<e.length;r++){var i=e[r];"'"===i?n+=i+i:"\\"===i?(n+=i+i,t=!0):n+=i}return n+="'",!0===t&&(n=" E"+n),n}},{key:"_pulseQueryQueue",value:function(){var e=this;if(!0===this.readyForQuery)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;var t=this.activeQuery.submit(this.connection);t&&a.nextTick((function(){e.activeQuery.handleError(t,e.connection),e.readyForQuery=!0,e._pulseQueryQueue()}))}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}},{key:"query",value:function(e,t,n){var r,i,s,o,u,c=this;if(null==e)throw new TypeError("Client was passed a null or undefined query");return"function"==typeof e.submit?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,"function"==typeof t&&(r.callback=r.callback||t)):(s=this.connectionParameters.query_timeout,(r=new f(e,t,n)).callback||(i=new this._Promise((function(e,t){r.callback=function(n,r){return n?t(n):e(r)}})))),s&&(u=r.callback,o=setTimeout((function(){var e=new Error("Query read timeout");a.nextTick((function(){r.handleError(e,c.connection)})),u(e),r.callback=function(){};var t=c.queryQueue.indexOf(r);t>-1&&c.queryQueue.splice(t,1),c._pulseQueryQueue()}),s),r.callback=function(e,t){clearTimeout(o),u(e,t)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(a.nextTick((function(){r.handleError(new Error("Client was closed and is not queryable"),c.connection)})),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(a.nextTick((function(){r.handleError(new Error("Client has encountered a connection error and is not queryable"),c.connection)})),i)}},{key:"ref",value:function(){this.connection.ref()}},{key:"unref",value:function(){this.connection.unref()}},{key:"end",value:function(e){var t=this;if(this._ending=!0,!this.connection._connecting){if(!e)return this._Promise.resolve();e()}if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),!e)return new this._Promise((function(e){t.connection.once("end",e)}));this.connection.once("end",e)}}]),n}(n);p.Query=f,t.exports=p})),hn=C((function(e,t){N();var n=D().EventEmitter,s=function(){},o=function(e,t){var n=e.findIndex(t);return-1===n?void 0:e.splice(n,1)[0]},u=v((function e(t,n,r){y(this,e),this.client=t,this.idleListener=n,this.timeoutId=r})),c=v((function e(t){y(this,e),this.callback=t}));function f(e,t){if(t)return{callback:t,result:void 0};var n,r;return{callback:function(e,t){e?n(e):r(t)},result:new e((function(e,t){r=e,n=t}))}}var h=function(e){w(n,e);var t=m(n);function n(e,i){var s;return y(this,n),(s=t.call(this)).options=Object.assign({},e),null!=e&&"password"in e&&Object.defineProperty(s.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),null!=e&&e.ssl&&e.ssl.key&&Object.defineProperty(s.options.ssl,"key",{enumerable:!1}),s.options.max=s.options.max||s.options.poolSize||10,s.options.maxUses=s.options.maxUses||1/0,s.options.allowExitOnIdle=s.options.allowExitOnIdle||!1,s.options.maxLifetimeSeconds=s.options.maxLifetimeSeconds||0,s.log=s.options.log||function(){},s.Client=s.options.Client||i||wn().Client,s.Promise=s.options.Promise||r.Promise,typeof s.options.idleTimeoutMillis>"u"&&(s.options.idleTimeoutMillis=1e4),s._clients=[],s._idle=[],s._expired=new WeakSet,s._pendingQueue=[],s._endCallback=void 0,s.ending=!1,s.ended=!1,s}return v(n,[{key:"_isFull",value:function(){return this._clients.length>=this.options.max}},{key:"_pulseQueue",value:function(){var e=this;if(this.log("pulse queue"),this.ended)this.log("pulse queue ended");else{if(this.ending)return this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map((function(t){e._remove(t.client)})),void(this._clients.length||(this.ended=!0,this._endCallback()));if(this._pendingQueue.length){if(this._idle.length||!this._isFull()){var t=this._pendingQueue.shift();if(this._idle.length){var n=this._idle.pop();clearTimeout(n.timeoutId);var r=n.client;r.ref&&r.ref();var i=n.idleListener;return this._acquireClient(r,t,i,!1)}if(!this._isFull())return this.newClient(t);throw new Error("unexpected condition")}}else this.log("no queued requests")}}},{key:"_remove",value:function(e){var t=o(this._idle,(function(t){return t.client===e}));void 0!==t&&clearTimeout(t.timeoutId),this._clients=this._clients.filter((function(t){return t!==e})),e.end(),this.emit("remove",e)}},{key:"connect",value:function(e){var t=this;if(this.ending){var n=new Error("Cannot use a pool after calling end on the pool");return e?e(n):this.Promise.reject(n)}var r=f(this.Promise,e),i=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&a.nextTick((function(){return t._pulseQueue()})),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new c(r.callback)),i;var s=function(e,t,n){clearTimeout(h),r.callback(e,t,n)},u=new c(s),h=setTimeout((function(){o(t._pendingQueue,(function(e){return e.callback===s})),u.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))}),this.options.connectionTimeoutMillis);return this._pendingQueue.push(u),i}return this.newClient(new c(r.callback)),i}},{key:"newClient",value:function(e){var t=this,n=new this.Client(this.options);this._clients.push(n);var r=function(e,t){return function n(r){r.client=t,t.removeListener("error",n),t.on("error",(function(){e.log("additional client error after disconnection due to error",r)})),e._remove(t),e.emit("error",r,t)}}(this,n);this.log("checking client timeout");var i,o=!1;this.options.connectionTimeoutMillis&&(i=setTimeout((function(){t.log("ending client due to timeout"),o=!0,n.connection?n.connection.stream.destroy():n.end()}),this.options.connectionTimeoutMillis)),this.log("connecting new client"),n.connect((function(a){if(i&&clearTimeout(i),n.on("error",r),!a){if(t.log("new client connected"),0!==t.options.maxLifetimeSeconds){var u=setTimeout((function(){t.log("ending client due to expired lifetime"),t._expired.add(n),-1!==t._idle.findIndex((function(e){return e.client===n}))&&t._acquireClient(n,new c((function(e,t,n){return n()})),r,!1)}),1e3*t.options.maxLifetimeSeconds);u.unref(),n.once("end",(function(){return clearTimeout(u)}))}return t._acquireClient(n,e,r,!0)}t.log("client failed to connect",a),t._clients=t._clients.filter((function(e){return e!==n})),o&&(a.message="Connection terminated due to connection timeout"),t._pulseQueue(),e.timedOut||e.callback(a,void 0,s)}))}},{key:"_acquireClient",value:function(e,t,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),t.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,(function(n){if(n)return e.release(n),t.callback(n,void 0,s);t.callback(void 0,e,e.release)})):t.callback(void 0,e,e.release)}},{key:"_releaseOnce",value:function(e,t){var n=this,r=!1;return function(i){r&&function(){throw new Error("Release called on client which has already been released to the pool.")}(),r=!0,n._release(e,t,i)}}},{key:"_release",value:function(e,t,n){var r,i=this;return e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses?(e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),void this._pulseQueue()):this._expired.has(e)?(this.log("remove expired client"),this._expired.delete(e),this._remove(e),void this._pulseQueue()):(this.options.idleTimeoutMillis&&(r=setTimeout((function(){i.log("remove idle client"),i._remove(e)}),this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&r.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new u(e,t,r)),void this._pulseQueue())}},{key:"query",value:function(e,t,n){var r=this;if("function"==typeof e){var s=f(this.Promise,e);return i((function(){return s.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))})),s.result}"function"==typeof t&&(n=t,t=void 0);var o=f(this.Promise,n);return n=o.callback,this.connect((function(i,s){if(i)return n(i);var o=!1,a=function(e){o||(o=!0,s.release(e),n(e))};s.once("error",a),r.log("dispatching query");try{s.query(e,t,(function(e,t){if(r.log("query dispatched"),s.removeListener("error",a),!o)return o=!0,s.release(e),e?n(e):n(void 0,t)}))}catch(u){return s.release(u),n(u)}})),o.result}},{key:"end",value:function(e){if(this.log("ending"),this.ending){var t=new Error("Called end on pool more than once");return e?e(t):this.Promise.reject(t)}this.ending=!0;var n=f(this.Promise,e);return this._endCallback=n.callback,this._pulseQueue(),n.result}},{key:"waitingCount",get:function(){return this._pendingQueue.length}},{key:"idleCount",get:function(){return this._idle.length}},{key:"expiredCount",get:function(){var e=this;return this._clients.reduce((function(t,n){return t+(e._expired.has(n)?1:0)}),0)}},{key:"totalCount",get:function(){return this._clients.length}}]),n}(n);t.exports=h})),ln={};L(ln,{default:function(){return pn}});var pn,dn=U((function(){N(),pn={}})),yn=C((function(e,t){N();var n=D().EventEmitter,r=(xe(),T(me)),s=ie(),o=t.exports=function(e,t,r){n.call(this),e=s.normalizeQueryConfig(e,t,r),this.text=e.text,this.values=e.values,this.name=e.name,this.callback=e.callback,this.state="new",this._arrayMode="array"===e.rowMode,this._emitRowEvents=!1,this.on("newListener",function(e){"row"===e&&(this._emitRowEvents=!0)}.bind(this))};r.inherits(o,n);var u={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};o.prototype.handleError=function(e){var t=this.native.pq.resultErrorFields();if(t)for(var n in t){e[u[n]||n]=t[n]}this.callback?this.callback(e):this.emit("error",e),this.state="error"},o.prototype.then=function(e,t){return this._getPromise().then(e,t)},o.prototype.catch=function(e){return this._getPromise().catch(e)},o.prototype._getPromise=function(){return this._promise||(this._promise=new Promise(function(e,t){this._once("end",e),this._once("error",t)}.bind(this))),this._promise},o.prototype.submit=function(e){this.state="running";var t=this;this.native=e.native,e.native.arrayMode=this._arrayMode;var n=function(n,r,s){if(e.native.arrayMode=!1,i((function(){t.emit("_done")})),n)return t.handleError(n);t._emitRowEvents&&(s.length>1?r.forEach((function(e,n){e.forEach((function(e){t.emit("row",e,s[n])}))})):r.forEach((function(e){t.emit("row",e,s)}))),t.state="end",t.emit("end",s),t.callback&&t.callback(null,s)};if(a.domain&&(n=a.domain.bind(n)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var r=(this.values||[]).map(s.prepareValue);if(e.namedQueries[this.name]){if(this.text&&e.namedQueries[this.name]!==this.text){var o=new Error("Prepared statements must be unique - '".concat(this.name,"' was used for a different statement"));return n(o)}return e.native.execute(this.name,r,n)}return e.native.prepare(this.name,this.text,r.length,(function(i){return i?n(i):(e.namedQueries[t.name]=t.text,t.native.execute(t.name,r,n))}))}if(this.values){if(!Array.isArray(this.values)){var u=new Error("Query values must be an array");return n(u)}var c=this.values.map(s.prepareValue);e.native.query(this.text,c,n)}else e.native.query(this.text,n)}})),vn=C((function(e,t){N();var n=(dn(),T(ln)),i=Ae(),s=D().EventEmitter,o=(xe(),T(me)),u=Te(),c=yn(),f=t.exports=function(e){s.call(this),e=e||{},this._Promise=e.Promise||r.Promise,this._types=new i(e.types),this.native=new n({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var t=this.connectionParameters=new u(e);this.user=t.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:t.password}),this.database=t.database,this.host=t.host,this.port=t.port,this.namedQueries={}};f.Query=c,o.inherits(f,s),f.prototype._errorAllQueries=function(e){var t=this,n=function(n){a.nextTick((function(){n.native=t.native,n.handleError(e)}))};this._hasActiveQuery()&&(n(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(n),this._queryQueue.length=0},f.prototype._connect=function(e){var t=this;this._connecting?a.nextTick((function(){return e(new Error("Client has already been connected. You cannot reuse a client."))})):(this._connecting=!0,this.connectionParameters.getLibpqConnectionString((function(n,r){if(n)return e(n);t.native.connect(r,(function(n){if(n)return t.native.end(),e(n);t._connected=!0,t.native.on("error",(function(e){t._queryable=!1,t._errorAllQueries(e),t.emit("error",e)})),t.native.on("notification",(function(e){t.emit("notification",{channel:e.relname,payload:e.extra})})),t.emit("connect"),t._pulseQueryQueue(!0),e()}))})))},f.prototype.connect=function(e){var t=this;if(!e)return new this._Promise((function(e,n){t._connect((function(t){t?n(t):e()}))}));this._connect(e)},f.prototype.query=function(e,t,n){var r,i,s,o,u,f=this;if(null==e)throw new TypeError("Client was passed a null or undefined query");if("function"==typeof e.submit)s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,"function"==typeof t&&(e.callback=t);else if(s=this.connectionParameters.query_timeout,!(r=new c(e,t,n)).callback){var h,l;i=new this._Promise((function(e,t){h=e,l=t})),r.callback=function(e,t){return e?l(e):h(t)}}return s&&(u=r.callback,o=setTimeout((function(){var e=new Error("Query read timeout");a.nextTick((function(){r.handleError(e,f.connection)})),u(e),r.callback=function(){};var t=f._queryQueue.indexOf(r);t>-1&&f._queryQueue.splice(t,1),f._pulseQueryQueue()}),s),r.callback=function(e,t){clearTimeout(o),u(e,t)}),this._queryable?this._ending?(r.native=this.native,a.nextTick((function(){r.handleError(new Error("Client was closed and is not queryable"))})),i):(this._queryQueue.push(r),this._pulseQueryQueue(),i):(r.native=this.native,a.nextTick((function(){r.handleError(new Error("Client has encountered a connection error and is not queryable"))})),i)},f.prototype.end=function(e){var t,n=this;return this._ending=!0,this._connected||this.once("connect",this.end.bind(this,e)),e||(t=new this._Promise((function(t,n){e=function(e){return e?n(e):t()}}))),this.native.end((function(){n._errorAllQueries(new Error("Connection terminated")),a.nextTick((function(){n.emit("end"),e&&e()}))})),t},f.prototype._hasActiveQuery=function(){return this._activeQuery&&"error"!==this._activeQuery.state&&"end"!==this._activeQuery.state},f.prototype._pulseQueryQueue=function(e){if(this._connected&&!this._hasActiveQuery()){var t=this._queryQueue.shift();if(!t)return void(e||this.emit("drain"));this._activeQuery=t,t.submit(this);var n=this;t.once("_done",(function(){n._pulseQueryQueue()}))}},f.prototype.cancel=function(e){this._activeQuery===e?this.native.cancel((function(){})):-1!==this._queryQueue.indexOf(e)&&this._queryQueue.splice(this._queryQueue.indexOf(e),1)},f.prototype.ref=function(){},f.prototype.unref=function(){},f.prototype.setTypeParser=function(e,t,n){return this._types.setTypeParser(e,t,n)},f.prototype.getTypeParser=function(e,t){return this._types.getTypeParser(e,t)}})),gn=C((function(e,t){N(),t.exports=vn()})),wn=C((function(e,t){N();var n=fn(),r=re(),i=cn(),s=hn(),o=sn().DatabaseError,u=function(e){this.defaults=r,this.Client=e,this.Query=this.Client.Query,this.Pool=function(e){return function(t){w(r,t);var n=m(r);function r(t){return y(this,r),n.call(this,t,e)}return v(r)}(s)}(this.Client),this._pools=[],this.Connection=i,this.types=ne(),this.DatabaseError=o};typeof a.env.NODE_PG_FORCE_NATIVE<"u"?t.exports=new u(gn()):(t.exports=new u(n),Object.defineProperty(t.exports,"native",{configurable:!0,enumerable:!1,get:function(){var e=null;try{e=new u(gn())}catch(n){if("MODULE_NOT_FOUND"!==n.code)throw n}return Object.defineProperty(t.exports,"native",{value:e}),e}}))})),mn={};L(mn,{Client:function(){return Sn},ClientBase:function(){return xn.ClientBase},Connection:function(){return xn.Connection},DatabaseError:function(){return xn.DatabaseError},Pool:function(){return En},Query:function(){return xn.Query},defaults:function(){return xn.defaults},neonConfig:function(){return Zt},types:function(){return xn.types}}),e.exports=T(mn),N();var bn=M(wn());zt();var xn=M(wn()),Sn=function(e){w(n,e);var t=m(n);function n(){return y(this,n),t.apply(this,arguments)}return v(n,[{key:"neonConfig",get:function(){return this.connection.stream}},{key:"connect",value:function(e){var t=this;this.ssl&&this.neonConfig.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=true in the connection string) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. Please disable SSL on the Postgres connection."),"localhost"===this.host&&console.warn("The database host is 'localhost', which is the default host when none is set. If that's intentional, please ignore this warning. If not, perhaps an environment variable has not been set, or has not been passed to the library?");var r=u(c(n.prototype),"connect",this).call(this,e),i=this.neonConfig.pipelineTLS&&this.ssl,s="password"===this.neonConfig.pipelineConnect;if(!i&&!this.neonConfig.pipelineConnect)return r;var o=this.connection;if(i&&o.on("connect",(function(){return o.stream.emit("data","S")})),s){o.removeAllListeners("authenticationCleartextPassword"),o.removeAllListeners("readyForQuery"),o.once("readyForQuery",(function(){return o.on("readyForQuery",t._handleReadyForQuery.bind(t))}));var a=this.ssl?"sslconnect":"connect";o.on(a,(function(){t._handleAuthCleartextPassword(),t._handleReadyForQuery()}))}return r}},{key:"_handleAuthSASLContinue",value:function(){var e=l(h().mark((function e(t){var n,r,i,a,u,c,f,l,p,d,y,v,g,w,m,b,x,S,E,A,_,k,U,C,L,I,M,T,R,P;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.saslSession,r=this.password,i=t.data,"SASLInitialResponse"===n.message&&"string"==typeof r&&"string"==typeof i){e.next=3;break}throw new Error("SASL: protocol error");case 3:if(a=Object.fromEntries(i.split(",").map((function(e){if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");return[e[0],e.substring(2)]}))),u=a.r,c=a.s,f=a.i,u&&/^[!-+--~]+$/.test(u)){e.next=6;break}throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");case 6:if(c&&/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(c)){e.next=8;break}throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");case 8:if(f&&/^[1-9][0-9]*$/.test(f)){e.next=10;break}throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");case 10:if(u.startsWith(n.clientNonce)){e.next=12;break}throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");case 12:if(u.length!==n.clientNonce.length){e.next=14;break}throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");case 14:return l=parseInt(f,10),p=o.from(c,"base64"),d=new TextEncoder,y=d.encode(r),e.next=20,s.subtle.importKey("raw",y,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);case 20:return v=e.sent,e.t0=Uint8Array,e.next=24,s.subtle.sign("HMAC",v,o.concat([p,o.from([0,0,0,1])]));case 24:e.t1=e.sent,g=new e.t0(e.t1),w=g,m=0;case 28:if(!(m<l-1)){e.next=38;break}return e.t2=Uint8Array,e.next=32,s.subtle.sign("HMAC",v,g);case 32:e.t3=e.sent,g=new e.t2(e.t3),w=o.from(w.map((function(e,t){return w[t]^g[t]})));case 35:m++,e.next=28;break;case 38:return b=w,e.next=41,s.subtle.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);case 41:return x=e.sent,e.t4=Uint8Array,e.next=45,s.subtle.sign("HMAC",x,d.encode("Client Key"));case 45:return e.t5=e.sent,S=new e.t4(e.t5),e.next=49,s.subtle.digest("SHA-256",S);case 49:return E=e.sent,A="n=*,r="+n.clientNonce,k=A+","+("r="+u+",s="+c+",i="+l)+","+(_="c=biws,r="+u),e.next=56,s.subtle.importKey("raw",E,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);case 56:return U=e.sent,e.t6=Uint8Array,e.next=60,s.subtle.sign("HMAC",U,d.encode(k));case 60:return e.t7=e.sent,C=new e.t6(e.t7),L=o.from(S.map((function(e,t){return S[t]^C[t]}))),I=L.toString("base64"),e.next=66,s.subtle.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);case 66:return M=e.sent,e.next=69,s.subtle.sign("HMAC",M,d.encode("Server Key"));case 69:return T=e.sent,e.next=72,s.subtle.importKey("raw",T,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);case 72:return R=e.sent,e.t8=o,e.next=76,s.subtle.sign("HMAC",R,d.encode(k));case 76:e.t9=e.sent,P=e.t8.from.call(e.t8,e.t9),n.message="SASLResponse",n.serverSignature=P.toString("base64"),n.response=_+",p="+I,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response);case 79:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(bn.Client),En=function(e){w(n,e);var t=m(n);function n(){var e;return y(this,n),e=t.apply(this,arguments),R(g(e),"Client",Sn),e}return v(n)}(bn.Pool)},9040:function(e){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},9889:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,n){var r=n(3897);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},7156:function(e){function t(e,t,n,r,i,s,o){try{var a=e[s](o),u=a.value}catch(c){return void n(c)}a.done?t(u):Promise.resolve(u).then(r,i)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(i,s){var o=e.apply(n,r);function a(e){t(o,i,s,a,u,"next",e)}function u(e){t(o,i,s,a,u,"throw",e)}a(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,n){var r=n(6015),i=n(9617);function s(t,n,o){return i()?(e.exports=s=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=s=function(e,t,n){var i=[null];i.push.apply(i,t);var s=new(Function.bind.apply(e,i));return n&&r(s,n.prototype),s},e.exports.__esModule=!0,e.exports.default=e.exports),s.apply(null,arguments)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,n){var r=n(4062);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,n){var r=n(6116);e.exports=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,n){var r=n(4968),i=n(9617),s=n(4993);e.exports=function(e){var t=i();return function(){var n,i=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return s(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},1588:function(e,t,n){var r=n(1753);function i(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,n){var i=r(e,t);if(i){var s=Object.getOwnPropertyDescriptor(i,t);return s.get?s.get.call(arguments.length<3?e:n):s.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},4968:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,n){var r=n(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},6035:function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6530:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s,o,a=[],u=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=s.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(f){c=!0,i=f}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,n){var r=n(8698).default,i=n(6115);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var r=n(9889),i=n(6530),s=n(6116),o=n(2218);e.exports=function(e,t){return r(e)||i(e,t)||s(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},1753:function(e,t,n){var r=n(4968);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,n){var r=n(3405),i=n(9498),s=n(6116),o=n(2281);e.exports=function(e){return r(e)||i(e)||s(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,n){var r=n(8698).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,n){var r=n(8698).default,i=n(5036);e.exports=function(e){var t=i(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var r=n(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},3496:function(e,t,n){var r=n(4968),i=n(6015),s=n(6035),o=n(3515);function a(t){var n="function"===typeof Map?new Map:void 0;return e.exports=a=function(e){if(null===e||!s(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return o(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},1413:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(4942);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},6435:function(e,t,n){"use strict";n.d(t,{db:function(){return U}});var r=n(3433),i=n(1120);function s(){return s="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,i.Z)(e)););return e}(e,t);if(r){var s=Object.getOwnPropertyDescriptor(r,t);return s.get?s.get.call(arguments.length<3?e:n):s.value}},s.apply(this,arguments)}var o=n(1413),a=n(4165),u=n(9439),c=n(5861),f=n(3144),h=n(5671),l=n(136),p=n(7277),d=n(8737),y=n(5790),v=y.Client,g=(y.ClientBase,y.Connection,y.DatabaseError,y.Pool),w=(y.Query,y.defaults,y.neonConfig),m=(y.types,function(e){(0,l.Z)(n,e);var t=(0,p.Z)(n);function n(e,r){var i;return(0,h.Z)(this,n),(i=t.call(this,"VercelPostgresError - '".concat(e,"': ").concat(r))).code=e,i.name="VercelPostgresError",i}return(0,f.Z)(n)}((0,d.Z)(Error)));function b(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pool";switch(t){case"pool":e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.POSTGRES_URL;break;case"direct":e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.POSTGRES_URL_NON_POOLING;break;default:throw new m("invalid_connection_type","Unhandled type: ".concat(t))}return"undefined"===e&&(e=void 0),e}function x(e){return e.includes("-pooler.")}function S(e){for(var t="",n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var s=0;s<e.length;s++)t+=e[s],s<r.length&&(t+="$".concat(s+1));return[t,r]}var E=function(e){(0,l.Z)(n,e);var t=(0,p.Z)(n);function n(){return(0,h.Z)(this,n),t.apply(this,arguments)}return(0,f.Z)(n,[{key:"sql",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var n,r,i,s,o,c,f,h=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=h.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=h[i];return s=S.apply(void 0,[t].concat(r)),o=(0,u.Z)(s,2),c=o[0],f=o[1],e.abrupt("return",this.query(c,f));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(v);var A=function(e){(0,l.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;return(0,h.Z)(this,n),(e=t.apply(this,arguments)).Client=E,e}return(0,f.Z)(n,[{key:"sql",value:function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var n,r,i,s,o,c,f,h=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=h.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=h[i];return s=S.apply(void 0,[t].concat(r)),o=(0,u.Z)(s,2),c=o[0],f=o[1],e.abrupt("return",this.query(c,f));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"connect",value:function(e){return s((0,i.Z)(n.prototype),"connect",this).call(this,e)}}]),n}(g);function _(e){var t,n=null!==(t=null==e?void 0:e.connectionString)&&void 0!==t?t:b("pool");if(!n)throw new m("missing_connection_string","You did not supply a 'connectionString' and no 'POSTGRES_URL' env var was found.");if(!x(n))throw new m("invalid_connection_string","This connection string is meant to be used with a direct connection. Make sure to use a pooled connection string or try `createClient()` instead.");var r=null==e?void 0:e.maxUses;return typeof EdgeRuntime<"u"&&(r&&1!==r&&console.warn("@vercel/postgres: Overriding `maxUses` to 1 because the EdgeRuntime does not support client reuse."),r=1),new A((0,o.Z)((0,o.Z)({},e),{},{connectionString:n,maxUses:r}))}var k,U=new Proxy((function(){}),{get:function(e,t){return k||(k=_()),Reflect.get(k,t)},apply:function(e,t,n){var i;return k||(k=_()),(i=k).sql.apply(i,(0,r.Z)(n))}}),C=n(9040);w&&(w.webSocketConstructor=C)}}]);
//# sourceMappingURL=435.f6a1ba1c.chunk.js.map